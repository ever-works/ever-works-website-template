diff --git a/app/[locale]/admin/auth/signin/page.tsx b/app/[locale]/admin/auth/signin/page.tsx
index 67f1f80..f085d08 100644
--- a/app/[locale]/admin/auth/signin/page.tsx
+++ b/app/[locale]/admin/auth/signin/page.tsx
@@ -1,14 +1,16 @@
 "use client";
 
 import { AuthForm } from "@/app/[locale]/auth/components/auth-form";
-import { useParams, useRouter } from "next/navigation";
+import { useParams } from "next/navigation";
 
 export default function AdminLoginPage() {
   const params = useParams();
-  const router = useRouter();
+  // const router = useRouter(); // Removed - using window.location.href instead
 
   const handleLoginSuccess = () => {
-    router.push(`/${params.locale}/admin`);
+    console.log('DEBUG: Admin login success, redirecting to:', `/${params.locale}/admin`);
+    // Force a page reload to ensure session is properly loaded in middleware
+    window.location.href = `/${params.locale}/admin`;
   };
 
   return (
diff --git a/app/[locale]/admin/clients/[id]/page.tsx b/app/[locale]/admin/clients/[id]/page.tsx
new file mode 100644
index 0000000..c9a5c8c
--- /dev/null
+++ b/app/[locale]/admin/clients/[id]/page.tsx
@@ -0,0 +1,487 @@
+import { notFound, redirect } from "next/navigation";
+import { auth } from "@/lib/auth";
+import { getClientProfileById } from "@/lib/db/queries";
+import { db } from "@/lib/db/drizzle";
+import { accounts, type ClientProfile } from "@/lib/db/schema";
+import { eq } from "drizzle-orm";
+import { Link } from "@/i18n/navigation";
+import { getLocale } from "next-intl/server";
+import { Button, Card, CardBody, Chip } from "@heroui/react";
+import { 
+  ArrowLeft, 
+  Mail, 
+  User, 
+  Building2, 
+  Globe, 
+  Phone, 
+  MapPin, 
+  Calendar,
+  Shield,
+  CreditCard,
+  Clock,
+  Languages,
+  Star,
+  ExternalLink,
+  Edit,
+  MessageSquare
+} from "lucide-react";
+
+type Params = { id: string; locale?: string };
+
+export default async function ClientDetailPage({
+  params,
+}: {
+  params: Promise<Params>;
+}) {
+  const { id } = await params;
+
+  const session = await auth();
+  if (!session?.user?.isAdmin) {
+    const locale = (await getLocale()) || "en";
+    redirect(`/${locale}/auth/signin`);
+  }
+
+  const profile: ClientProfile | null = await getClientProfileById(id);
+  if (!profile) {
+    notFound();
+  }
+
+  const linkedAccounts = await db
+    .select()
+    .from(accounts)
+    .where(eq(accounts.userId, profile.userId));
+
+  const locale = (await getLocale()) || "en";
+
+  return (
+    <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
+      {/* Modern Gradient Header */}
+      <div className="bg-gradient-to-r from-white via-gray-50 to-white dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 border-b border-gray-100 dark:border-gray-800 shadow-lg">
+        <div className="max-w-7xl mx-auto px-6 py-8">
+          <div className="flex items-center justify-between mb-6">
+            <Link href={`/${locale}/admin/clients`}>
+              <Button
+                variant="light"
+                size="sm"
+                startContent={<ArrowLeft className="w-4 h-4" />}
+                className="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors"
+              >
+                Back to Clients
+              </Button>
+            </Link>
+            <div className="flex items-center space-x-3">
+              <Button
+                color="primary"
+                variant="flat"
+                size="sm"
+                startContent={<Edit className="w-4 h-4" />}
+                className="bg-gradient-to-r from-theme-primary to-theme-accent text-white shadow-lg hover:shadow-xl transition-all duration-300"
+              >
+                Edit Client
+              </Button>
+              <Button
+                color="default"
+                variant="bordered"
+                size="sm"
+                startContent={<MessageSquare className="w-4 h-4" />}
+                className="border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"
+              >
+                Send Message
+              </Button>
+            </div>
+          </div>
+
+          {/* Client Header Card */}
+          <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 p-8">
+            <div className="flex flex-col lg:flex-row lg:items-start gap-6">
+              <div className="flex items-center space-x-6">
+                <div className="relative">
+                  <div className="w-20 h-20 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-xl">
+                    <span className="text-2xl font-bold text-white">
+                      {(profile.displayName || profile.username || 'U').charAt(0).toUpperCase()}
+                    </span>
+                  </div>
+                  <div className="absolute -bottom-2 -right-2 w-6 h-6 bg-green-500 border-2 border-white dark:border-gray-800 rounded-full flex items-center justify-center">
+                    <div className="w-2 h-2 bg-white rounded-full"></div>
+                  </div>
+                </div>
+                <div className="flex-1">
+                  <div className="flex items-center space-x-3 mb-2">
+                    <h1 className="text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent">
+                      {profile.displayName || profile.username || 'Unnamed Client'}
+                    </h1>
+                    {profile.company && (
+                      <span className="px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-sm font-medium">
+                        {profile.company}
+                      </span>
+                    )}
+                  </div>
+                  <div className="flex items-center space-x-4 mb-3">
+                    <span className="text-gray-600 dark:text-gray-400 font-mono text-sm">
+                      #{profile.id.slice(0, 8)}
+                    </span>
+                    <Chip size="sm" color={getStatusColor(profile.status || 'active')} variant="flat" className="shadow-sm">
+                      {(profile.status || 'active').charAt(0).toUpperCase() + (profile.status || 'active').slice(1)}
+                    </Chip>
+                    <Chip size="sm" color={getPlanColor(profile.plan || 'free')} variant="flat" className="shadow-sm">
+                      {(profile.plan || 'free').charAt(0).toUpperCase() + (profile.plan || 'free').slice(1)}
+                    </Chip>
+                  </div>
+                  {profile.jobTitle && (
+                    <p className="text-gray-600 dark:text-gray-400 mb-2">
+                      {profile.jobTitle}
+                    </p>
+                  )}
+                  <div className="flex items-center space-x-6 text-sm text-gray-500 dark:text-gray-400">
+                    <div className="flex items-center space-x-2">
+                      <Calendar className="w-4 h-4" />
+                      <span>Joined {toDateTime(profile.createdAt)}</span>
+                    </div>
+                    <div className="flex items-center space-x-2">
+                      <Star className="w-4 h-4" />
+                      <span>{profile.totalSubmissions || 0} submissions</span>
+                    </div>
+                  </div>
+                </div>
+              </div>
+            </div>
+          </div>
+        </div>
+      </div>
+
+      {/* Content Area */}
+      <div className="max-w-7xl mx-auto px-6 py-8">
+        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
+          {/* Main Content */}
+          <div className="lg:col-span-2 space-y-8">
+            {/* Profile Information */}
+            <Card className="border-0 shadow-xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm">
+              <CardBody className="p-0">
+                <div className="px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-700">
+                  <div className="flex items-center space-x-3">
+                    <User className="w-5 h-5 text-blue-600 dark:text-blue-400" />
+                    <h2 className="text-lg font-semibold text-gray-900 dark:text-white">Profile Information</h2>
+                  </div>
+                </div>
+                <div className="p-6">
+                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+                    <ModernField 
+                      icon={<User className="w-4 h-4 text-blue-500" />}
+                      label="Display Name" 
+                      value={profile.displayName || "Not provided"} 
+                    />
+                    <ModernField 
+                      icon={<User className="w-4 h-4 text-green-500" />}
+                      label="Username" 
+                      value={profile.username ? `@${profile.username}` : "Not set"} 
+                    />
+                    <ModernField 
+                      icon={<Building2 className="w-4 h-4 text-purple-500" />}
+                      label="Company" 
+                      value={profile.company || "Not provided"} 
+                    />
+                    <ModernField 
+                      icon={<Building2 className="w-4 h-4 text-orange-500" />}
+                      label="Job Title" 
+                      value={profile.jobTitle || "Not provided"} 
+                    />
+                    <ModernField 
+                      icon={<Shield className="w-4 h-4 text-indigo-500" />}
+                      label="Account Type" 
+                      value={(profile.accountType || 'individual').charAt(0).toUpperCase() + (profile.accountType || 'individual').slice(1)} 
+                    />
+                    <ModernField 
+                      icon={<CreditCard className="w-4 h-4 text-pink-500" />}
+                      label="Subscription Plan" 
+                      value={(profile.plan || 'free').charAt(0).toUpperCase() + (profile.plan || 'free').slice(1)} 
+                    />
+                  </div>
+                  {profile.bio && (
+                    <div className="mt-6 pt-6 border-t border-gray-100 dark:border-gray-700">
+                      <div className="flex items-center space-x-2 mb-3">
+                        <MessageSquare className="w-4 h-4 text-gray-600 dark:text-gray-400" />
+                        <span className="text-sm font-medium text-gray-900 dark:text-white">Bio</span>
+                      </div>
+                      <div className="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-xl p-4 border border-blue-100 dark:border-blue-800">
+                        <p className="text-gray-700 dark:text-gray-300 leading-relaxed">
+                          {profile.bio}
+                        </p>
+                      </div>
+                    </div>
+                  )}
+                </div>
+              </CardBody>
+            </Card>
+
+            {/* Contact Information */}
+            <Card className="border-0 shadow-xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm">
+              <CardBody className="p-0">
+                <div className="px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-700">
+                  <div className="flex items-center space-x-3">
+                    <Mail className="w-5 h-5 text-green-600 dark:text-green-400" />
+                    <h2 className="text-lg font-semibold text-gray-900 dark:text-white">Contact & Details</h2>
+                  </div>
+                </div>
+                <div className="p-6">
+                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+                    <ModernField 
+                      icon={<Phone className="w-4 h-4 text-green-500" />}
+                      label="Phone" 
+                      value={profile.phone || "Not provided"} 
+                    />
+                    <ModernField 
+                      icon={<Globe className="w-4 h-4 text-blue-500" />}
+                      label="Website" 
+                      value={profile.website || "Not provided"}
+                      isLink={!!profile.website}
+                    />
+                    <ModernField 
+                      icon={<MapPin className="w-4 h-4 text-red-500" />}
+                      label="Location" 
+                      value={profile.location || "Not provided"} 
+                    />
+                    <ModernField 
+                      icon={<Building2 className="w-4 h-4 text-purple-500" />}
+                      label="Industry" 
+                      value={profile.industry || "Not specified"} 
+                    />
+                    <ModernField 
+                      icon={<Languages className="w-4 h-4 text-orange-500" />}
+                      label="Language" 
+                      value={profile.language?.toUpperCase() || "EN"} 
+                    />
+                    <ModernField 
+                      icon={<Clock className="w-4 h-4 text-indigo-500" />}
+                      label="Timezone" 
+                      value={profile.timezone || "UTC"} 
+                    />
+                  </div>
+                </div>
+              </CardBody>
+            </Card>
+          </div>
+
+          {/* Sidebar */}
+          <div className="space-y-8">
+            {/* Account Status */}
+            <Card className="border-0 shadow-xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm">
+              <CardBody className="p-0">
+                <div className="px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-700">
+                  <div className="flex items-center space-x-3">
+                    <Shield className="w-5 h-5 text-purple-600 dark:text-purple-400" />
+                    <h2 className="text-lg font-semibold text-gray-900 dark:text-white">Security & Status</h2>
+                  </div>
+                </div>
+                <div className="p-6 space-y-4">
+                  <div className="flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl border border-green-100 dark:border-green-800">
+                    <div className="flex items-center space-x-3">
+                      <Mail className="w-5 h-5 text-green-600 dark:text-green-400" />
+                      <span className="font-medium text-gray-900 dark:text-white">Email Verified</span>
+                    </div>
+                    <Chip 
+                      size="sm" 
+                      color={profile.emailVerified ? 'success' : 'danger'} 
+                      variant="flat"
+                      className="shadow-sm"
+                    >
+                      {profile.emailVerified ? 'Verified' : 'Unverified'}
+                    </Chip>
+                  </div>
+                  <div className="flex items-center justify-between p-4 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 rounded-xl border border-blue-100 dark:border-blue-800">
+                    <div className="flex items-center space-x-3">
+                      <Shield className="w-5 h-5 text-blue-600 dark:text-blue-400" />
+                      <span className="font-medium text-gray-900 dark:text-white">Two-Factor Auth</span>
+                    </div>
+                    <Chip 
+                      size="sm" 
+                      color={profile.twoFactorEnabled ? 'success' : 'default'} 
+                      variant="flat"
+                      className="shadow-sm"
+                    >
+                      {profile.twoFactorEnabled ? 'Enabled' : 'Disabled'}
+                    </Chip>
+                  </div>
+                  <div className="pt-4 border-t border-gray-100 dark:border-gray-700">
+                    <div className="grid grid-cols-2 gap-4 text-center">
+                      <div className="p-3 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-lg">
+                        <div className="text-2xl font-bold text-blue-600 dark:text-blue-400">
+                          {profile.totalSubmissions || 0}
+                        </div>
+                        <div className="text-xs text-gray-600 dark:text-gray-400">Submissions</div>
+                      </div>
+                      <div className="p-3 bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-lg">
+                        <div className="text-2xl font-bold text-purple-600 dark:text-purple-400">
+                          {linkedAccounts.length}
+                        </div>
+                        <div className="text-xs text-gray-600 dark:text-gray-400">Accounts</div>
+                      </div>
+                    </div>
+                  </div>
+                </div>
+              </CardBody>
+            </Card>
+
+            {/* Linked Accounts */}
+            <Card className="border-0 shadow-xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm">
+              <CardBody className="p-0">
+                <div className="px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-700">
+                  <div className="flex items-center justify-between">
+                    <div className="flex items-center space-x-3">
+                      <Shield className="w-5 h-5 text-orange-600 dark:text-orange-400" />
+                      <h2 className="text-lg font-semibold text-gray-900 dark:text-white">Linked Accounts</h2>
+                    </div>
+                    <Chip size="sm" variant="flat" color="primary" className="shadow-sm">
+                      {linkedAccounts.length}
+                    </Chip>
+                  </div>
+                </div>
+                <div className="p-6">
+                  {linkedAccounts.length === 0 ? (
+                    <div className="text-center py-8">
+                      <Shield className="w-12 h-12 text-gray-400 mx-auto mb-4" />
+                      <p className="text-gray-500 dark:text-gray-400">No linked accounts</p>
+                    </div>
+                  ) : (
+                    <div className="space-y-3">
+                      {linkedAccounts.map((acc: typeof accounts.$inferSelect) => (
+                        <div 
+                          key={`${acc.provider}:${acc.providerAccountId}`} 
+                          className="flex items-center justify-between p-4 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-700 rounded-xl border border-gray-100 dark:border-gray-700 hover:shadow-md transition-all duration-200"
+                        >
+                          <div className="flex items-center space-x-3">
+                            <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-lg">
+                              <ExternalLink className="w-5 h-5 text-white" />
+                            </div>
+                            <div>
+                              <h4 className="font-semibold text-gray-900 dark:text-white capitalize">{acc.provider}</h4>
+                              <p className="text-sm text-gray-500 dark:text-gray-400">{acc.type}</p>
+                            </div>
+                          </div>
+                          <div className="text-right">
+                            <p className="text-sm font-mono text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">
+                              {acc.providerAccountId.slice(0, 8)}...
+                            </p>
+                          </div>
+                        </div>
+                      ))}
+                    </div>
+                  )}
+                </div>
+              </CardBody>
+            </Card>
+
+            {/* Billing & Subscription */}
+            <Card className="border-0 shadow-xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm">
+              <CardBody className="p-0">
+                <div className="px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-700">
+                  <div className="flex items-center space-x-3">
+                    <CreditCard className="w-5 h-5 text-green-600 dark:text-green-400" />
+                    <h2 className="text-lg font-semibold text-gray-900 dark:text-white">Billing & Plans</h2>
+                  </div>
+                </div>
+                <div className="p-6">
+                  <div className="text-center py-8">
+                    <div className="w-16 h-16 bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/30 rounded-2xl flex items-center justify-center mx-auto mb-4">
+                      <CreditCard className="w-8 h-8 text-green-600 dark:text-green-400" />
+                    </div>
+                    <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-2">No billing setup</h3>
+                    <p className="text-gray-500 dark:text-gray-400 mb-4 text-sm">
+                      Payment and subscription details will appear here once configured.
+                    </p>
+                    <Button 
+                      color="primary" 
+                      variant="flat" 
+                      size="sm"
+                      className="bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg hover:shadow-xl transition-all duration-300"
+                    >
+                      Set up billing
+                    </Button>
+                  </div>
+                </div>
+              </CardBody>
+            </Card>
+          </div>
+        </div>
+      </div>
+    </div>
+  );
+}
+
+function ModernField({ 
+  icon, 
+  label, 
+  value,
+  isLink = false
+}: { 
+  icon: React.ReactNode; 
+  label: string; 
+  value?: string | null;
+  isLink?: boolean;
+}) {
+  return (
+    <div className="p-4 bg-gradient-to-r from-gray-50/50 to-white/50 dark:from-gray-800/50 dark:to-gray-700/50 rounded-xl border border-gray-100 dark:border-gray-700 hover:shadow-md transition-all duration-200">
+      <div className="flex items-center space-x-3 mb-2">
+        {icon}
+        <span className="text-sm font-medium text-gray-600 dark:text-gray-400">{label}</span>
+      </div>
+      <div className="text-gray-900 dark:text-white font-medium">
+        {isLink && value && value !== "Not provided" ? (
+          <a 
+            href={value.startsWith('http') ? value : `https://${value}`} 
+            target="_blank" 
+            rel="noopener noreferrer"
+            className="text-blue-600 dark:text-blue-400 hover:underline flex items-center space-x-1"
+          >
+            <span>{value}</span>
+            <ExternalLink className="w-3 h-3" />
+          </a>
+        ) : (
+          value || "—"
+        )}
+      </div>
+    </div>
+  );
+}
+
+function getStatusColor(status: string) {
+  switch (status) {
+    case 'active':
+      return 'success';
+    case 'inactive':
+      return 'default';
+    case 'suspended':
+      return 'danger';
+    case 'trial':
+      return 'warning';
+    default:
+      return 'default';
+  }
+}
+
+function getPlanColor(plan: string) {
+  switch (plan) {
+    case 'premium':
+      return 'success';
+    case 'standard':
+      return 'primary';
+    case 'free':
+      return 'default';
+    default:
+      return 'default';
+  }
+}
+
+function toDateTime(date: unknown): string {
+  try {
+    if (!date) return "—";
+    const d = new Date(String(date));
+    if (Number.isNaN(d.getTime())) return "—";
+    return new Intl.DateTimeFormat("en-US", {
+      year: "numeric",
+      month: "short",
+      day: "2-digit",
+    }).format(d);
+  } catch {
+    return "—";
+  }
+}
\ No newline at end of file
diff --git a/app/[locale]/admin/clients/page.tsx b/app/[locale]/admin/clients/page.tsx
index 95b676e..21fa4d7 100644
--- a/app/[locale]/admin/clients/page.tsx
+++ b/app/[locale]/admin/clients/page.tsx
@@ -1,15 +1,18 @@
 "use client";
 
-import { useState, useEffect, useCallback } from "react";
+import { useState, useEffect, useCallback, useRef } from "react";
 import { Button, Card, CardBody, Chip, useDisclosure } from "@heroui/react";
-import { Plus, Edit, Trash2, Eye } from "lucide-react";
+import { Plus, Edit, Trash2, Users, UserCheck, UserX, Search, ChevronDown, Building2, Eye } from "lucide-react";
 import { toast } from "sonner";
 import { ClientForm } from "@/components/admin/clients/client-form";
 import { UniversalPagination } from "@/components/universal-pagination";
+import { useRouter, useParams } from "next/navigation";
 import type { ClientListResponse, ClientResponse, CreateClientRequest, UpdateClientRequest } from "@/lib/types/client";
 import type { ClientProfileWithUser } from "@/lib/db/schema";
 
 export default function ClientsPage() {
+  const router = useRouter();
+  const params = useParams();
   const [clients, setClients] = useState<ClientProfileWithUser[]>([]);
   const [isLoading, setIsLoading] = useState(true);
   const [isSubmitting, setIsSubmitting] = useState(false);
@@ -26,24 +29,24 @@ export default function ClientsPage() {
   
   // Filter state
   const [searchTerm, setSearchTerm] = useState('');
-  const [statusFilter, setStatusFilter] = useState<string>('');
+  const [statusFilter, setStatusFilter] = useState<string>('active');
   const [planFilter, setPlanFilter] = useState<string>('');
   const [accountTypeFilter, setAccountTypeFilter] = useState<string>('');
+  const [isFiltering, setIsFiltering] = useState(false);
+  
+  // Stats state
+  const [stats, setStats] = useState({ total: 0, active: 0, inactive: 0, suspended: 0 });
   
   const { isOpen, onOpen, onClose } = useDisclosure();
   const { isOpen: isDeleteOpen, onOpen: onDeleteOpen, onClose: onDeleteClose } = useDisclosure();
-
-  const inputClass =
-    "w-full pl-10 pr-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500";
-
-  const selectClass =
-    "px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500";
-
-  const buttonClass =
-    "px-4 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors";
-
+  
   // Debounced search term
   const [debouncedSearchTerm, setDebouncedSearchTerm] = useState(searchTerm);
+  
+  // Track if this is the initial load
+  const isInitialLoad = useRef(true);
+
+
 
   // Debounce search term
   useEffect(() => {
@@ -54,10 +57,26 @@ export default function ClientsPage() {
     return () => clearTimeout(timer);
   }, [searchTerm]);
 
+  // Fetch stats
+  const fetchStats = useCallback(async () => {
+    try {
+      const response = await fetch('/api/admin/clients/stats');
+      if (response.ok) {
+        const data = await response.json();
+        if (data.success) {
+          setStats(data.data);
+        }
+      }
+    } catch (error) {
+      console.error('Failed to fetch stats:', error);
+    }
+  }, []);
+
   // Fetch clients
   const fetchClients = useCallback(async (page: number = currentPage) => {
     try {
       setIsLoading(true);
+      setIsFiltering(true);
       const params = new URLSearchParams({ 
         page: String(page), 
         limit: String(limit) 
@@ -88,6 +107,7 @@ export default function ClientsPage() {
       toast.error('Failed to fetch clients');
     } finally {
       setIsLoading(false);
+      setIsFiltering(false);
     }
   }, [debouncedSearchTerm, statusFilter, planFilter, accountTypeFilter, currentPage, limit]);
 
@@ -213,6 +233,11 @@ export default function ClientsPage() {
     onOpen();
   };
 
+  const viewClientDetails = (clientId: string) => {
+    const locale = params.locale || 'en';
+    router.push(`/${locale}/admin/clients/${clientId}`);
+  };
+
   const handleFormSubmit = async (data: CreateClientRequest | UpdateClientRequest) => {
     if (formMode === 'create') {
       await handleCreate(data as CreateClientRequest);
@@ -227,15 +252,67 @@ export default function ClientsPage() {
 
   const clearFilters = () => {
     setSearchTerm('');
-    setStatusFilter('');
+    setStatusFilter('active');
     setPlanFilter('');
     setAccountTypeFilter('');
     setCurrentPage(1);
+    fetchClients(1);
+  };
+
+  const handleSearch = (value: string) => {
+    setSearchTerm(value);
+    setCurrentPage(1);
+  };
+
+  const handleStatusFilter = (value: string) => {
+    setStatusFilter(value);
+    setCurrentPage(1);
+    fetchClients(1);
   };
 
+  const handlePlanFilter = (value: string) => {
+    setPlanFilter(value);
+    setCurrentPage(1);
+    fetchClients(1);
+  };
+
+  const handleAccountTypeFilter = (value: string) => {
+    setAccountTypeFilter(value);
+    setCurrentPage(1);
+    fetchClients(1);
+  };
+
+  // Initial fetch on component mount
+  useEffect(() => {
+    const loadInitialData = async () => {
+      await fetchClients();
+      await fetchStats();
+      isInitialLoad.current = false; // Mark initial load as complete
+    };
+    loadInitialData();
+    // eslint-disable-next-line react-hooks/exhaustive-deps
+  }, []); // Only run on mount
+
+  // Fetch when filters change (excluding search term which has its own debounced effect)
+  useEffect(() => {
+    // Skip if this is the initial load
+    if (!isInitialLoad.current) {
+      fetchClients(1);
+    }
+    // eslint-disable-next-line react-hooks/exhaustive-deps
+  }, [statusFilter, planFilter, accountTypeFilter]);
+
+  // Debounced search effect
   useEffect(() => {
-    fetchClients();
-  }, [fetchClients]);
+    const timeoutId = setTimeout(() => {
+      if (searchTerm !== '') {
+        fetchClients(1);
+      }
+    }, 300);
+
+    return () => clearTimeout(timeoutId);
+    // eslint-disable-next-line react-hooks/exhaustive-deps
+  }, [searchTerm]);
 
   const getStatusColor = (status: string) => {
     switch (status) {
@@ -265,182 +342,367 @@ export default function ClientsPage() {
     }
   };
 
-  return (
-    <div className="space-y-6">
-      {/* Header */}
-      <div className="flex items-center justify-between">
-        <div>
-          <h1 className="text-2xl font-bold text-gray-900 dark:text-white">Client Management</h1>
-          <p className="text-gray-600 dark:text-gray-400 mt-1">
-            Manage your clients and their information
-          </p>
+  if (isLoading && clients.length === 0) {
+    return (
+      <div className="p-6 max-w-7xl mx-auto">
+        {/* Loading Header */}
+        <div className="mb-8">
+          <div className="bg-gradient-to-r from-white via-gray-50 to-white dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-lg p-6">
+            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
+              <div className="flex items-center space-x-4">
+                <div className="w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"></div>
+                <div>
+                  <div className="h-8 w-48 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse mb-2"></div>
+                  <div className="h-4 w-64 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"></div>
+                </div>
+              </div>
+              <div className="h-12 w-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"></div>
+            </div>
+          </div>
+        </div>
+
+        {/* Loading Stats */}
+        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
+          {Array.from({ length: 4 }, (_, i) => (
+            <Card key={i} className="border-0 shadow-lg">
+              <CardBody className="p-6">
+                <div className="flex items-center justify-between">
+                  <div className="flex-1">
+                    <div className="h-4 w-24 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-2"></div>
+                    <div className="h-8 w-16 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"></div>
+                  </div>
+                  <div className="w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"></div>
+                </div>
+              </CardBody>
+            </Card>
+          ))}
         </div>
-        <Button
-          color="primary"
-          onPress={openCreateForm}
-          startContent={<Plus className="w-4 h-4" />}
-        >
-          Add Client
-        </Button>
       </div>
+    );
+  }
 
-      {/* Filters */}
-      <div className="flex flex-col sm:flex-row gap-4 mb-6">
-        {/* Search */}
-        <div className="flex-1">
-          <div className="relative">
-            <input
-              type="text"
-              placeholder="Search clients..."
-              value={searchTerm}
-              onChange={(e) => setSearchTerm(e.target.value)}
-              className={inputClass}
-            />
-            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
-              <svg className="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
-                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
-              </svg>
+  return (
+    <div className="p-6 max-w-7xl mx-auto">
+      {/* Modern Header */}
+      <div className="mb-8">
+        <div className="bg-gradient-to-r from-white via-gray-50 to-white dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-lg p-6">
+          <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
+            <div className="flex items-center space-x-4">
+              <div className="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
+                <Building2 className="w-6 h-6 text-white" />
+              </div>
+              <div>
+                <h1 className="text-2xl font-bold text-gray-900 dark:text-white">Client Management</h1>
+                <p className="text-gray-600 dark:text-gray-400 mt-1">
+                  Manage your clients and their information
+                </p>
+              </div>
             </div>
+            <Button
+              color="primary"
+              size="lg"
+              onPress={openCreateForm}
+              startContent={<Plus size={18} />}
+              className="bg-gradient-to-r from-theme-primary to-theme-accent hover:from-theme-primary/90 hover:to-theme-accent/90 shadow-lg shadow-theme-primary/25 hover:shadow-xl hover:shadow-theme-primary/40 transition-all duration-300 text-white font-medium"
+            >
+              Add Client
+            </Button>
           </div>
         </div>
+      </div>
+
+      {/* Stats Cards */}
+      <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
+        <Card className="border-0 shadow-lg">
+          <CardBody className="p-6">
+            <div className="flex items-center justify-between">
+              <div className="flex-1">
+                <p className="text-sm font-medium text-gray-600 dark:text-gray-400">Total Clients</p>
+                <p className="text-2xl font-bold text-gray-900 dark:text-white">{stats.total}</p>
+              </div>
+              <div className="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg">
+                <Users className="w-6 h-6 text-white" />
+              </div>
+            </div>
+          </CardBody>
+        </Card>
+
+        <Card className="border-0 shadow-lg">
+          <CardBody className="p-6">
+            <div className="flex items-center justify-between">
+              <div className="flex-1">
+                <p className="text-sm font-medium text-gray-600 dark:text-gray-400">Active Clients</p>
+                <p className="text-2xl font-bold text-gray-900 dark:text-white">{stats.active}</p>
+              </div>
+              <div className="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center shadow-lg">
+                <UserCheck className="w-6 h-6 text-white" />
+              </div>
+            </div>
+          </CardBody>
+        </Card>
+
+        <Card className="border-0 shadow-lg">
+          <CardBody className="p-6">
+            <div className="flex items-center justify-between">
+              <div className="flex-1">
+                <p className="text-sm font-medium text-gray-600 dark:text-gray-400">Inactive Clients</p>
+                <p className="text-2xl font-bold text-gray-900 dark:text-white">{stats.inactive}</p>
+              </div>
+              <div className="w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl flex items-center justify-center shadow-lg">
+                <UserX className="w-6 h-6 text-white" />
+              </div>
+            </div>
+          </CardBody>
+        </Card>
+
+        <Card className="border-0 shadow-lg">
+          <CardBody className="p-6">
+            <div className="flex items-center justify-between">
+              <div className="flex-1">
+                <p className="text-sm font-medium text-gray-600 dark:text-gray-400">Suspended</p>
+                <p className="text-2xl font-bold text-gray-900 dark:text-white">{stats.suspended}</p>
+              </div>
+              <div className="w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center shadow-lg">
+                <UserX className="w-6 h-6 text-white" />
+              </div>
+            </div>
+          </CardBody>
+        </Card>
+      </div>
 
-        {/* Filter Buttons */}
-        <div className="flex gap-2">
+      {/* Modern SaaS-Style Filters */}
+      <div className="mb-6">
+        {/* Search Bar */}
+        <div className="relative mb-4">
+          <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400" />
+          <input
+            type="text"
+            placeholder="Search clients..."
+            value={searchTerm}
+            onChange={(e) => handleSearch(e.target.value)}
+            className="w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-theme-primary/20 focus:border-theme-primary transition-all duration-200 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"
+          />
+          {isFiltering && (
+            <div className="absolute right-4 top-1/2 transform -translate-y-1/2">
+              <div className="w-4 h-4 border-2 border-theme-primary border-t-transparent rounded-full animate-spin"></div>
+            </div>
+          )}
+        </div>
+
+        {/* Filter Pills */}
+        <div className="flex flex-wrap items-center gap-3">
           {/* Status Filter */}
-          <select
-            value={statusFilter}
-            onChange={(e) => setStatusFilter(e.target.value)}
-            className={selectClass}
-          >
-            <option value="">All Status</option>
-            <option value="active">Active</option>
-            <option value="inactive">Inactive</option>
-            <option value="suspended">Suspended</option>
-            <option value="trial">Trial</option>
-          </select>
+          <div className="relative">
+            <select 
+              value={statusFilter} 
+              onChange={(e) => handleStatusFilter(e.target.value)}
+              className="appearance-none bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full px-4 py-2 pr-8 text-sm font-medium text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-theme-primary/20 focus:border-theme-primary transition-all duration-200 cursor-pointer"
+            >
+              <option value="active">Active</option>
+              <option value="">All Status</option>
+              <option value="inactive">Inactive</option>
+              <option value="suspended">Suspended</option>
+              <option value="trial">Trial</option>
+            </select>
+            <ChevronDown className="absolute right-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none" />
+          </div>
 
           {/* Plan Filter */}
-          <select
-            value={planFilter}
-            onChange={(e) => setPlanFilter(e.target.value)}
-            className={selectClass}
-          >
-            <option value="">All Plans</option>
-            <option value="free">Free</option>
-            <option value="standard">Standard</option>
-            <option value="premium">Premium</option>
-          </select>
+          <div className="relative">
+            <select 
+              value={planFilter} 
+              onChange={(e) => handlePlanFilter(e.target.value)}
+              className="appearance-none bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full px-4 py-2 pr-8 text-sm font-medium text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-theme-primary/20 focus:border-theme-primary transition-all duration-200 cursor-pointer"
+            >
+              <option value="">All Plans</option>
+              <option value="free">Free</option>
+              <option value="standard">Standard</option>
+              <option value="premium">Premium</option>
+            </select>
+            <ChevronDown className="absolute right-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none" />
+          </div>
 
           {/* Account Type Filter */}
-          <select
-            value={accountTypeFilter}
-            onChange={(e) => setAccountTypeFilter(e.target.value)}
-            className={selectClass}
-          >
-            <option value="">All Types</option>
-            <option value="individual">Individual</option>
-            <option value="business">Business</option>
-            <option value="enterprise">Enterprise</option>
-          </select>
-
-          {/* Clear Filters Button */}
-          {(searchTerm || statusFilter || planFilter || accountTypeFilter) && (
-            <button
-              onClick={clearFilters}
-              className={buttonClass}
+          <div className="relative">
+            <select 
+              value={accountTypeFilter} 
+              onChange={(e) => handleAccountTypeFilter(e.target.value)}
+              className="appearance-none bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full px-4 py-2 pr-8 text-sm font-medium text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-theme-primary/20 focus:border-theme-primary transition-all duration-200 cursor-pointer"
             >
-              Clear
-            </button>
-          )}
+              <option value="">All Types</option>
+              <option value="individual">Individual</option>
+              <option value="business">Business</option>
+              <option value="enterprise">Enterprise</option>
+            </select>
+            <ChevronDown className="absolute right-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none" />
+          </div>
         </div>
+
+        {/* Active Filters Indicator */}
+        {(searchTerm || statusFilter !== 'active' || planFilter || accountTypeFilter) && (
+          <div className="flex items-center justify-between mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800">
+            <span className="text-sm text-blue-700 dark:text-blue-300">
+              {[
+                searchTerm && 'search',
+                statusFilter !== 'active' && 'status',
+                planFilter && 'plan',
+                accountTypeFilter && 'type'
+              ].filter(Boolean).length} filter{[
+                searchTerm && 'search',
+                statusFilter !== 'active' && 'status', 
+                planFilter && 'plan',
+                accountTypeFilter && 'type'
+              ].filter(Boolean).length !== 1 ? 's' : ''} applied
+            </span>
+            <Button
+              variant="light"
+              size="sm"
+              color="danger"
+              onPress={clearFilters}
+              className="h-6 px-2 text-xs"
+            >
+              Clear all
+            </Button>
+          </div>
+        )}
+
+        {/* Results Summary */}
+        {!isLoading && (
+          <div className="mt-4 flex items-center justify-between text-sm text-gray-600 dark:text-gray-400">
+            <span>
+              Showing {clients.length} of {stats.total} clients
+              {(searchTerm || statusFilter !== 'active' || planFilter || accountTypeFilter) && (
+                <span className="ml-1">
+                  • filtered
+                </span>
+              )}
+            </span>
+            {totalPages > 1 && (
+              <span>
+                Page {currentPage} of {totalPages}
+              </span>
+            )}
+          </div>
+        )}
       </div>
 
-      {/* Clients List */}
-      <Card className="bg-white dark:bg-gray-800">
-        <CardBody>
-          {isLoading ? (
-            <div className="text-center py-8">
-              <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
-              <p className="mt-2 text-gray-600 dark:text-gray-400">Loading clients...</p>
+      {/* Clients Table */}
+      <Card className="border-0 shadow-lg">
+        <CardBody className="p-0">
+          <div className="px-6 py-4 border-b border-gray-100 dark:border-gray-800 bg-gray-50/50 dark:bg-gray-800/50">
+            <div className="flex items-center justify-between">
+              <h3 className="text-lg font-semibold text-gray-900 dark:text-white">Clients</h3>
+              <span className="text-sm text-gray-500 dark:text-gray-400">
+                {stats.total} clients total
+              </span>
             </div>
-          ) : clients.length === 0 ? (
-            <div className="text-center py-8">
-              <Eye className="w-12 h-12 text-gray-400 mx-auto mb-4" />
+          </div>
+          
+          {clients.length === 0 ? (
+            <div className="px-6 py-12 text-center">
+              <Building2 className="w-12 h-12 text-gray-400 mx-auto mb-4" />
               <h3 className="text-lg font-medium text-gray-900 dark:text-white mb-2">No clients found</h3>
-              <p className="text-gray-600 dark:text-gray-400 mb-4">
-                {searchTerm || statusFilter || planFilter || accountTypeFilter 
+              <p className="text-gray-500 dark:text-gray-400 mb-4">
+                {searchTerm || statusFilter !== 'active' || planFilter || accountTypeFilter
                   ? 'Try adjusting your filters or search terms.'
                   : 'Get started by adding your first client.'
                 }
               </p>
-              {!searchTerm && !statusFilter && !planFilter && !accountTypeFilter && (
+              {!searchTerm && statusFilter === 'active' && !planFilter && !accountTypeFilter && (
                 <Button color="primary" onPress={openCreateForm}>
                   Add First Client
                 </Button>
               )}
             </div>
           ) : (
-            <div className="space-y-4">
+            <div className="divide-y divide-gray-100 dark:divide-gray-800">
               {clients.map((client) => (
-                <div
-                  key={client.id}
-                  className="flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
-                >
-                  <div className="flex-1">
-                    <div className="flex items-center space-x-3">
-                      <div>
-                        <h3 className="font-medium text-gray-900 dark:text-white">
-                          {client.displayName || client.user.name || 'Unnamed Client'}
-                        </h3>
-                        <p className="text-sm text-gray-600 dark:text-gray-400">
-                          {client.user.email}
-                        </p>
-                        {client.username && (
-                          <p className="text-xs text-gray-500 dark:text-gray-500">
-                            @{client.username}
-                          </p>
-                        )}
-                        {client.jobTitle && (
-                          <p className="text-xs text-gray-500 dark:text-gray-500">
-                            {client.jobTitle}
+                <div key={client.id} className="px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors">
+                  <div className="flex items-center justify-between">
+                    <div className="flex items-center space-x-4 flex-1">
+                      <div className="flex items-center space-x-2">
+                        <div className="w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
+                        <span className="text-sm text-gray-500 dark:text-gray-400">#{client.id.slice(0, 8)}</span>
+                      </div>
+                      <div 
+                        className="flex items-center space-x-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg p-2 -m-2 transition-colors"
+                        onClick={() => viewClientDetails(client.id)}
+                        title="Click to view client details"
+                      >
+                        <div className="w-10 h-10 bg-gradient-to-br from-theme-primary to-theme-accent rounded-full flex items-center justify-center text-white font-semibold text-sm">
+                          {(client.displayName || client.user.name || 'U').charAt(0).toUpperCase()}
+                        </div>
+                        <div className="flex-1">
+                          <h4 className="font-medium text-gray-900 dark:text-white hover:text-theme-primary transition-colors">
+                            {client.displayName || client.user.name || 'Unnamed Client'}
+                          </h4>
+                          <p className="text-sm text-gray-500 dark:text-gray-400">
+                            {client.username ? `@${client.username}` : ''} {client.username && client.user.email ? '•' : ''} {client.user.email}
                           </p>
-                        )}
+                          {client.jobTitle && (
+                            <p className="text-xs text-gray-400 dark:text-gray-500">{client.jobTitle}</p>
+                          )}
+                          {client.company && (
+                            <p className="text-xs text-gray-400 dark:text-gray-500">{client.company}</p>
+                          )}
+                        </div>
                       </div>
                     </div>
-                    
-                    <div className="flex items-center space-x-2 mt-2">
-                      <Chip size="sm" color={getStatusColor(client.status || 'active')}>
-                        {client.status || 'active'}
-                      </Chip>
-                      <Chip size="sm" color={getPlanColor(client.plan || 'free')}>
-                        {client.plan || 'free'}
-                      </Chip>
-                      <Chip size="sm" color={getAccountTypeColor(client.accountType || 'individual')}>
-                        {client.accountType || 'individual'}
-                      </Chip>
+                    <div className="flex items-center space-x-4">
+                      <div className="flex items-center space-x-2">
+                        <Chip
+                          color={getStatusColor(client.status || 'active')}
+                          variant="flat"
+                          size="sm"
+                        >
+                          {(client.status || 'active').charAt(0).toUpperCase() + (client.status || 'active').slice(1)}
+                        </Chip>
+                        <Chip
+                          color={getPlanColor(client.plan || 'free')}
+                          variant="flat"
+                          size="sm"
+                        >
+                          {(client.plan || 'free').charAt(0).toUpperCase() + (client.plan || 'free').slice(1)}
+                        </Chip>
+                        <Chip
+                          color={getAccountTypeColor(client.accountType || 'individual')}
+                          variant="flat"
+                          size="sm"
+                        >
+                          {(client.accountType || 'individual').charAt(0).toUpperCase() + (client.accountType || 'individual').slice(1)}
+                        </Chip>
+                      </div>
+                      <div className="flex items-center space-x-2">
+                        <Button
+                          size="sm"
+                          color="default"
+                          variant="light"
+                          onPress={() => viewClientDetails(client.id)}
+                          startContent={<Eye className="w-4 h-4" />}
+                        >
+                          View
+                        </Button>
+                        <Button
+                          size="sm"
+                          color="primary"
+                          variant="light"
+                          onPress={() => openEditForm(client)}
+                          startContent={<Edit className="w-4 h-4" />}
+                        >
+                          Edit
+                        </Button>
+                        <Button
+                          size="sm"
+                          color="danger"
+                          variant="light"
+                          onPress={() => handleDeleteClick(client.id)}
+                          startContent={<Trash2 className="w-4 h-4" />}
+                        >
+                          Delete
+                        </Button>
+                      </div>
                     </div>
                   </div>
-                  
-                  <div className="flex items-center space-x-2">
-                    <Button
-                      size="sm"
-                      color="primary"
-                      variant="bordered"
-                      onPress={() => openEditForm(client)}
-                      startContent={<Edit className="w-4 h-4" />}
-                    >
-                      Edit
-                    </Button>
-                    <Button
-                      size="sm"
-                      color="danger"
-                      variant="bordered"
-                      onPress={() => handleDeleteClick(client.id)}
-                      startContent={<Trash2 className="w-4 h-4" />}
-                    >
-                      Delete
-                    </Button>
-                  </div>
                 </div>
               ))}
             </div>
@@ -450,7 +712,7 @@ export default function ClientsPage() {
 
       {/* Pagination */}
       {totalPages > 1 && (
-        <div className="flex justify-center">
+        <div className="flex justify-center mt-8">
           <UniversalPagination
             page={currentPage}
             totalPages={totalPages}
diff --git a/app/[locale]/dashboard/page.tsx b/app/[locale]/dashboard/page.tsx
new file mode 100644
index 0000000..c3418a5
--- /dev/null
+++ b/app/[locale]/dashboard/page.tsx
@@ -0,0 +1,6 @@
+import { DashboardContent } from "@/components/dashboard/dashboard-content";
+
+export default function DashboardPage() {
+  // No auth required - pass null session
+  return <DashboardContent session={null} />;
+}
diff --git a/app/api/admin/clients/stats/route.ts b/app/api/admin/clients/stats/route.ts
new file mode 100644
index 0000000..ce74675
--- /dev/null
+++ b/app/api/admin/clients/stats/route.ts
@@ -0,0 +1,44 @@
+import { NextResponse } from 'next/server';
+import { auth } from '@/lib/auth';
+import { getClientProfiles } from '@/lib/db/queries';
+
+export async function GET() {
+  try {
+    const session = await auth();
+    
+    if (!session?.user?.isAdmin) {
+      return NextResponse.json({ 
+        success: false, 
+        error: 'Unauthorized' 
+      }, { status: 401 });
+    }
+
+    // Get all clients to calculate stats
+    const result = await getClientProfiles({
+      page: 1,
+      limit: 1000, // Get a large number to count all
+    });
+
+    const { profiles: clients } = result;
+
+    const stats = {
+      total: clients.length,
+      active: clients.filter(c => c.status === 'active').length,
+      inactive: clients.filter(c => c.status === 'inactive').length,
+      suspended: clients.filter(c => c.status === 'suspended').length,
+      trial: clients.filter(c => c.status === 'trial').length,
+    };
+
+    return NextResponse.json({
+      success: true,
+      data: stats
+    });
+
+  } catch (error) {
+    console.error('Error fetching client stats:', error);
+    return NextResponse.json({ 
+      success: false, 
+      error: 'Failed to fetch client stats' 
+    }, { status: 500 });
+  }
+}
diff --git a/app/api/auth/[...nextauth]/route.ts b/app/api/auth/[...nextauth]/route.ts
index 00e8df2..e0795e8 100644
--- a/app/api/auth/[...nextauth]/route.ts
+++ b/app/api/auth/[...nextauth]/route.ts
@@ -1,6 +1,9 @@
 import { NextRequest } from 'next/server';
 import { handleWithErrorHandling } from './error-wrapper';
 
+// Force Node.js runtime to avoid Edge Runtime database/crypto issues
+export const runtime = 'nodejs';
+
 /**
  * GET handler with error handling
  */
diff --git a/lib/auth/credentials.ts b/lib/auth/credentials.ts
index 291ca79..c1f7b87 100644
--- a/lib/auth/credentials.ts
+++ b/lib/auth/credentials.ts
@@ -64,7 +64,7 @@ export const credentialsProvider = Credentials({
         if (isPasswordValid) {
           // Allow authentication for any user in users table (admin)
           console.log('✅ Admin authentication successful');
-          			logActivity(ActivityType.SIGN_IN, foundUser.id);
+          logActivity(ActivityType.SIGN_IN, foundUser.id);
           // Return admin user with consistent structure
           return {
             ...foundUser,
@@ -99,7 +99,7 @@ export const credentialsProvider = Credentials({
             
             // Allow client authentication
             console.log('✅ Client authentication successful');
-            			logActivity(ActivityType.SIGN_IN, undefined, clientProfile.id);
+            logActivity(ActivityType.SIGN_IN, undefined, clientProfile.id);
             return clientUser;
           }
         }
diff --git a/lib/auth/index.ts b/lib/auth/index.ts
index ad45958..41c8291 100644
--- a/lib/auth/index.ts
+++ b/lib/auth/index.ts
@@ -131,7 +131,7 @@ export function getOrCreateStripeProvider(): StripeProvider {
 
 export const { handlers, auth, signIn, signOut, unstable_update } = NextAuth({
   adapter: drizzle,
-  session: { 
+  session: {
     strategy: "jwt",
     maxAge: 30 * 24 * 60 * 60, // 30 days
     updateAge: 24 * 60 * 60, // 24 hours
@@ -152,18 +152,28 @@ export const { handlers, auth, signIn, signOut, unstable_update } = NextAuth({
     },
     signIn: async ({ user, account }) => {
       try {
-        // Avoid any database work here (Edge runtime).
-        // If we have an email/user from provider, allow; otherwise, default to provider behavior.
         if (!user?.email) {
-          return account?.provider !== "credentials";
+          console.warn('Sign-in attempt without email', { provider: account?.provider });
+          return account?.provider !== 'credentials';
         }
+
+        // If DATABASE_URL is not set, we can't validate against the database
+        if (!process.env.DATABASE_URL) {
+          console.warn('DATABASE_URL is not set, skipping database validation');
+          // Allow OAuth sign-ins but not credentials without a database
+          return account?.provider !== 'credentials';
+        }
+
+        // For Edge runtime compatibility, avoid database calls in signIn callback
+        // Validation is handled in the credentials provider authorize function
         return true;
-      } catch {
-        return false;
+      } catch (error) {
+        console.error('Error during sign-in validation:', error);
+        return account?.provider !== 'credentials';
       }
     },
     jwt: async ({ token, user, account }) => {
-      // Do not query DB here (Edge runtime). Just carry flags from user if present.
+      // Handle user properties from credentials provider
       const extendedUser = user as ExtendedUser;
       
       if (extendedUser?.id && typeof extendedUser.id === "string") {
@@ -176,16 +186,24 @@ export const { handlers, auth, signIn, signOut, unstable_update } = NextAuth({
         token.provider = account.provider;
       }
       
-      // Set admin flag based on user properties
-      // Any user in the users table is considered an admin
-      // Client users (from client_profiles) are not admins
+      // Set admin flag based on user properties from credentials provider
+      // The credentials provider already determined admin status
       if (typeof extendedUser?.isClient === "boolean") {
         token.isAdmin = !extendedUser.isClient;
+      } else if (typeof extendedUser?.isAdmin === "boolean") {
+        token.isAdmin = extendedUser.isAdmin;
       } else {
-        // If user is not marked as client, they are from users table = admin
+        // Default for users table entries (admin users)
         token.isAdmin = true;
       }
       
+      console.log('DEBUG JWT: Token admin status set:', { 
+        isAdmin: token.isAdmin, 
+        isClient: extendedUser?.isClient,
+        userIsAdmin: extendedUser?.isAdmin,
+        email: extendedUser?.email || token.email
+      });
+      
       return token;
     },
     session: async ({ session, token }) => {
diff --git a/lib/db/migrations/0013_thin_scarlet_witch.sql b/lib/db/migrations/0013_thin_scarlet_witch.sql
index 25769d9..a12bba9 100644
--- a/lib/db/migrations/0013_thin_scarlet_witch.sql
+++ b/lib/db/migrations/0013_thin_scarlet_witch.sql
@@ -1,4 +1,8 @@
-ALTER TABLE "activityLogs" DROP CONSTRAINT "activityLogs_userId_users_id_fk";
+DO $$ BEGIN
+  ALTER TABLE "activityLogs" DROP CONSTRAINT "activityLogs_userId_users_id_fk";
+EXCEPTION WHEN undefined_object THEN NULL; END $$;
 --> statement-breakpoint
-ALTER TABLE "activityLogs" ADD COLUMN "ip_address" varchar(45);--> statement-breakpoint
-ALTER TABLE "activityLogs" DROP COLUMN "ipAddress";
\ No newline at end of file
+ALTER TABLE "activityLogs" ADD COLUMN IF NOT EXISTS "ip_address" varchar(45);--> statement-breakpoint
+DO $$ BEGIN
+  ALTER TABLE "activityLogs" DROP COLUMN "ipAddress";
+EXCEPTION WHEN undefined_column THEN NULL; END $$;
\ No newline at end of file
diff --git a/lib/db/migrations/0014_soft_reavers.sql b/lib/db/migrations/0014_soft_reavers.sql
index e514b1d..64d966d 100644
--- a/lib/db/migrations/0014_soft_reavers.sql
+++ b/lib/db/migrations/0014_soft_reavers.sql
@@ -1,4 +1,10 @@
+-- Cleanup null userId rows before enforcing NOT NULL
+DELETE FROM "accounts" WHERE "userId" IS NULL;
+
+-- Add user_type with default to avoid failures
+ALTER TABLE "accounts" ADD COLUMN IF NOT EXISTS "user_type" text NOT NULL DEFAULT 'client';--> statement-breakpoint
+
+-- Now enforce NOT NULL
 ALTER TABLE "accounts" ALTER COLUMN "userId" SET NOT NULL;--> statement-breakpoint
-ALTER TABLE "accounts" ADD COLUMN "user_type" text NOT NULL;--> statement-breakpoint
-CREATE INDEX "accounts_userId_userType_idx" ON "accounts" USING btree ("userId","user_type");--> statement-breakpoint
-CREATE INDEX "accounts_email_idx" ON "accounts" USING btree ("email");
\ No newline at end of file
+CREATE INDEX IF NOT EXISTS "accounts_userId_userType_idx" ON "accounts" USING btree ("userId","user_type");--> statement-breakpoint
+CREATE INDEX IF NOT EXISTS "accounts_email_idx" ON "accounts" USING btree ("email");
\ No newline at end of file
diff --git a/lib/db/migrations/0016_thankful_misty_knight.sql b/lib/db/migrations/0016_thankful_misty_knight.sql
index eaa6ab4..ceb9d79 100644
--- a/lib/db/migrations/0016_thankful_misty_knight.sql
+++ b/lib/db/migrations/0016_thankful_misty_knight.sql
@@ -1,10 +1,48 @@
-ALTER TABLE "subscriptions" ALTER COLUMN "start_date" DROP NOT NULL;--> statement-breakpoint
-ALTER TABLE "subscriptions" ALTER COLUMN "payment_provider" SET DEFAULT 'stripe';--> statement-breakpoint
-ALTER TABLE "subscriptions" ALTER COLUMN "subscription_id" DROP NOT NULL;--> statement-breakpoint
-ALTER TABLE "subscriptions" ALTER COLUMN "amount" SET DEFAULT 0;--> statement-breakpoint
-ALTER TABLE "subscriptions" ADD COLUMN "invoice_id" text;--> statement-breakpoint
-ALTER TABLE "subscriptions" ADD COLUMN "amount_due" integer DEFAULT 0;--> statement-breakpoint
-ALTER TABLE "subscriptions" ADD COLUMN "amount_paid" integer DEFAULT 0;--> statement-breakpoint
-ALTER TABLE "subscriptions" ADD COLUMN "hosted_invoice_url" text;--> statement-breakpoint
-ALTER TABLE "subscriptions" ADD COLUMN "invoice_pdf" text;--> statement-breakpoint
-ALTER TABLE "accounts" ADD CONSTRAINT "accounts_userId_client_profiles_id_fk" FOREIGN KEY ("userId") REFERENCES "public"."client_profiles"("id") ON DELETE cascade ON UPDATE no action;
\ No newline at end of file
+-- Make this migration idempotent and compatible with current schema
+
+-- Drop NOT NULL on subscriptions.start_date if column exists
+DO $$ BEGIN
+  IF EXISTS (
+    SELECT 1 FROM information_schema.columns 
+    WHERE table_schema = 'public' AND table_name = 'subscriptions' AND column_name = 'start_date'
+  ) THEN
+    EXECUTE 'ALTER TABLE "subscriptions" ALTER COLUMN "start_date" DROP NOT NULL';
+  END IF;
+END $$;
+
+-- Ensure subscriptions.payment_provider exists and set default
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "payment_provider" text;--> statement-breakpoint
+DO $$ BEGIN
+  IF EXISTS (
+    SELECT 1 FROM information_schema.columns 
+    WHERE table_schema = 'public' AND table_name = 'subscriptions' AND column_name = 'payment_provider'
+  ) THEN
+    EXECUTE 'ALTER TABLE "subscriptions" ALTER COLUMN "payment_provider" SET DEFAULT ''stripe''';
+  END IF;
+END $$;
+
+-- Ensure subscriptions.subscription_id column exists and is nullable
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "subscription_id" text;--> statement-breakpoint
+
+-- Ensure subscriptions.amount exists and default 0
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "amount" integer;--> statement-breakpoint
+DO $$ BEGIN
+  IF EXISTS (
+    SELECT 1 FROM information_schema.columns 
+    WHERE table_schema = 'public' AND table_name = 'subscriptions' AND column_name = 'amount'
+  ) THEN
+    EXECUTE 'ALTER TABLE "subscriptions" ALTER COLUMN "amount" SET DEFAULT 0';
+  END IF;
+END $$;
+
+-- Additional fields (add only if missing)
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "invoice_id" text;--> statement-breakpoint
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "amount_due" integer DEFAULT 0;--> statement-breakpoint
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "amount_paid" integer DEFAULT 0;--> statement-breakpoint
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "hosted_invoice_url" text;--> statement-breakpoint
+ALTER TABLE "subscriptions" ADD COLUMN IF NOT EXISTS "invoice_pdf" text;--> statement-breakpoint
+
+-- Add foreign key constraint for accounts.userId -> client_profiles.id (safe operation)
+DO $$ BEGIN
+  ALTER TABLE "accounts" ADD CONSTRAINT "accounts_userId_client_profiles_id_fk" FOREIGN KEY ("userId") REFERENCES "public"."client_profiles"("id") ON DELETE cascade ON UPDATE no action;
+EXCEPTION WHEN duplicate_object THEN NULL; END $$;
\ No newline at end of file
diff --git a/lib/db/migrations/0018_cultured_proemial_gods.sql b/lib/db/migrations/0018_cultured_proemial_gods.sql
index de64358..5d7c44e 100644
--- a/lib/db/migrations/0018_cultured_proemial_gods.sql
+++ b/lib/db/migrations/0018_cultured_proemial_gods.sql
@@ -1,5 +1,17 @@
-ALTER TABLE "activityLogs" ADD COLUMN "clientId" text;--> statement-breakpoint
-ALTER TABLE "activityLogs" ADD CONSTRAINT "activityLogs_userId_users_id_fk" FOREIGN KEY ("userId") REFERENCES "public"."users"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
-ALTER TABLE "activityLogs" ADD CONSTRAINT "activityLogs_clientId_client_profiles_id_fk" FOREIGN KEY ("clientId") REFERENCES "public"."client_profiles"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
-CREATE INDEX "activity_logs_user_idx" ON "activityLogs" USING btree ("userId");--> statement-breakpoint
-CREATE INDEX "activity_logs_client_idx" ON "activityLogs" USING btree ("clientId");
\ No newline at end of file
+ALTER TABLE "activityLogs" ADD COLUMN IF NOT EXISTS "clientId" text;--> statement-breakpoint
+
+-- Cleanup orphan activity logs before adding FK
+DELETE FROM "activityLogs" al
+WHERE al."userId" IS NOT NULL
+  AND NOT EXISTS (
+    SELECT 1 FROM "users" u WHERE u.id = al."userId"
+  );
+
+DO $$ BEGIN
+  ALTER TABLE "activityLogs" ADD CONSTRAINT "activityLogs_userId_users_id_fk" FOREIGN KEY ("userId") REFERENCES "public"."users"("id") ON DELETE cascade ON UPDATE no action;
+EXCEPTION WHEN duplicate_object THEN NULL; END $$;--> statement-breakpoint
+DO $$ BEGIN
+  ALTER TABLE "activityLogs" ADD CONSTRAINT "activityLogs_clientId_client_profiles_id_fk" FOREIGN KEY ("clientId") REFERENCES "public"."client_profiles"("id") ON DELETE cascade ON UPDATE no action;
+EXCEPTION WHEN duplicate_object THEN NULL; END $$;--> statement-breakpoint
+CREATE INDEX IF NOT EXISTS "activity_logs_user_idx" ON "activityLogs" USING btree ("userId");--> statement-breakpoint
+CREATE INDEX IF NOT EXISTS "activity_logs_client_idx" ON "activityLogs" USING btree ("clientId");
\ No newline at end of file
diff --git a/lib/db/migrations/0019_powerful_spitfire.sql b/lib/db/migrations/0019_powerful_spitfire.sql
index 69dc733..fcb1574 100644
--- a/lib/db/migrations/0019_powerful_spitfire.sql
+++ b/lib/db/migrations/0019_powerful_spitfire.sql
@@ -1,3 +1,7 @@
-ALTER TABLE "accounts" DROP CONSTRAINT "accounts_email_unique";--> statement-breakpoint
+-- Drop the global email unique constraint from accounts table
+DO $$ BEGIN
+  ALTER TABLE "accounts" DROP CONSTRAINT "accounts_email_unique";
+EXCEPTION WHEN undefined_object THEN NULL; END $$;
+--> statement-breakpoint
 -- Add provider-scoped unique index for credentials accounts only
 CREATE UNIQUE INDEX IF NOT EXISTS "accounts_credentials_email_unique" ON "accounts" ("email") WHERE "provider" = 'credentials';
\ No newline at end of file
diff --git a/lib/db/migrations/0020_create_payment_tables.sql b/lib/db/migrations/0020_create_payment_tables.sql
new file mode 100644
index 0000000..1f334a5
--- /dev/null
+++ b/lib/db/migrations/0020_create_payment_tables.sql
@@ -0,0 +1,43 @@
+-- Create payment providers table
+CREATE TABLE IF NOT EXISTS "paymentProviders" (
+  "id" text PRIMARY KEY NOT NULL,
+  "name" text NOT NULL,
+  "is_active" boolean DEFAULT true NOT NULL,
+  "created_at" timestamp DEFAULT now() NOT NULL,
+  "updated_at" timestamp DEFAULT now() NOT NULL,
+  CONSTRAINT "paymentProviders_name_unique" UNIQUE("name")
+);
+
+-- Create payment accounts table
+CREATE TABLE IF NOT EXISTS "paymentAccounts" (
+  "id" text PRIMARY KEY NOT NULL,
+  "userId" text NOT NULL,
+  "providerId" text NOT NULL,
+  "customerId" text NOT NULL,
+  "accountId" text,
+  "lastUsed" timestamp,
+  "created_at" timestamp DEFAULT now() NOT NULL,
+  "updated_at" timestamp DEFAULT now() NOT NULL
+);
+
+-- Add foreign key constraints safely
+DO $$ BEGIN
+  ALTER TABLE "paymentAccounts"
+    ADD CONSTRAINT "paymentAccounts_userId_users_id_fk"
+    FOREIGN KEY ("userId") REFERENCES "public"."users"("id") ON DELETE CASCADE;
+EXCEPTION WHEN duplicate_object THEN NULL; END $$;
+
+DO $$ BEGIN
+  ALTER TABLE "paymentAccounts"
+    ADD CONSTRAINT "paymentAccounts_providerId_paymentProviders_id_fk"
+    FOREIGN KEY ("providerId") REFERENCES "public"."paymentProviders"("id") ON DELETE CASCADE;
+EXCEPTION WHEN duplicate_object THEN NULL; END $$;
+
+-- Create indexes
+CREATE UNIQUE INDEX IF NOT EXISTS "user_provider_unique_idx" ON "paymentAccounts" ("userId", "providerId");
+CREATE UNIQUE INDEX IF NOT EXISTS "customer_provider_unique_idx" ON "paymentAccounts" ("customerId", "providerId");
+CREATE INDEX IF NOT EXISTS "payment_account_customer_id_idx" ON "paymentAccounts" ("customerId");
+CREATE INDEX IF NOT EXISTS "payment_account_provider_idx" ON "paymentAccounts" ("providerId");
+CREATE INDEX IF NOT EXISTS "payment_account_created_at_idx" ON "paymentAccounts" ("created_at");
+CREATE INDEX IF NOT EXISTS "payment_provider_active_idx" ON "paymentProviders" ("is_active");
+CREATE INDEX IF NOT EXISTS "payment_provider_created_at_idx" ON "paymentProviders" ("created_at");
diff --git a/lib/db/migrations/0021_cleanup_is_admin_column.sql b/lib/db/migrations/0021_cleanup_is_admin_column.sql
new file mode 100644
index 0000000..d3fa97e
--- /dev/null
+++ b/lib/db/migrations/0021_cleanup_is_admin_column.sql
@@ -0,0 +1,4 @@
+-- Cleanup migration for developers who still have the legacy is_admin column
+-- This ensures all environments are consistent with the role-based system
+
+ALTER TABLE "users" DROP COLUMN IF EXISTS "is_admin";
diff --git a/lib/db/migrations/0022_add_userid_to_client_profiles.sql b/lib/db/migrations/0022_add_userid_to_client_profiles.sql
new file mode 100644
index 0000000..b784609
--- /dev/null
+++ b/lib/db/migrations/0022_add_userid_to_client_profiles.sql
@@ -0,0 +1,69 @@
+-- Add userId column to client_profiles if not exists
+ALTER TABLE "client_profiles" ADD COLUMN IF NOT EXISTS "userId" text;
+
+-- For existing client_profiles without userId, we need to handle them carefully
+-- Since the system treats users table as admin and client_profiles as clients,
+-- we should create placeholder user records for existing client profiles
+
+-- Create user records for client profiles that don't have a userId
+INSERT INTO "users" (id, email, name, created_at, updated_at)
+SELECT 
+  gen_random_uuid(),
+  COALESCE(cp.display_name || '@placeholder.com', 'client-' || cp.id || '@placeholder.com'),
+  COALESCE(cp.display_name, 'Client User'),
+  cp.created_at,
+  cp.updated_at
+FROM "client_profiles" cp
+WHERE cp."userId" IS NULL
+ON CONFLICT (email) DO NOTHING;
+
+-- Update client_profiles to link to the created user records
+-- For simplicity, we'll create a one-to-one mapping
+DO $$
+DECLARE
+    profile_record RECORD;
+    user_id text;
+BEGIN
+    FOR profile_record IN 
+        SELECT id, display_name, created_at 
+        FROM client_profiles 
+        WHERE "userId" IS NULL
+    LOOP
+        -- Find or create a user for this profile
+        SELECT id INTO user_id 
+        FROM users 
+        WHERE email = COALESCE(profile_record.display_name || '@placeholder.com', 'client-' || profile_record.id || '@placeholder.com')
+        LIMIT 1;
+        
+        -- If no user found, create one
+        IF user_id IS NULL THEN
+            INSERT INTO users (id, email, name, created_at, updated_at)
+            VALUES (
+                gen_random_uuid(),
+                'client-' || profile_record.id || '@placeholder.com',
+                COALESCE(profile_record.display_name, 'Client User'),
+                profile_record.created_at,
+                now()
+            )
+            RETURNING id INTO user_id;
+        END IF;
+        
+        -- Update the client profile with the user id
+        UPDATE client_profiles 
+        SET "userId" = user_id 
+        WHERE id = profile_record.id;
+    END LOOP;
+END $$;
+
+-- Now add the NOT NULL constraint and foreign key
+ALTER TABLE "client_profiles" ALTER COLUMN "userId" SET NOT NULL;
+
+-- Add foreign key constraint if not exists
+DO $$ BEGIN
+  ALTER TABLE "client_profiles"
+    ADD CONSTRAINT "client_profiles_userId_users_id_fk"
+    FOREIGN KEY ("userId") REFERENCES "public"."users"("id") ON DELETE CASCADE;
+EXCEPTION WHEN duplicate_object THEN NULL; END $$;
+
+-- Create index if not exists
+CREATE INDEX IF NOT EXISTS "client_profile_user_id_idx" ON "client_profiles" ("userId");
diff --git a/lib/db/migrations/meta/0020_create_payment_tables_snapshot.json b/lib/db/migrations/meta/0020_create_payment_tables_snapshot.json
new file mode 100644
index 0000000..d9b854f
--- /dev/null
+++ b/lib/db/migrations/meta/0020_create_payment_tables_snapshot.json
@@ -0,0 +1,1635 @@
+{
+  "id": "20000000-0000-0000-0000-000000000020",
+  "prevId": "03764f05-9509-4dad-8cdf-5a0cc3c4c1be",
+  "version": "7",
+  "dialect": "postgresql",
+  "tables": {
+    "public.accounts": {
+      "name": "accounts",
+      "schema": "",
+      "columns": {
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "type": {
+          "name": "type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "provider": {
+          "name": "provider",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "providerAccountId": {
+          "name": "providerAccountId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "password_hash": {
+          "name": "password_hash",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "refresh_token": {
+          "name": "refresh_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "access_token": {
+          "name": "access_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "expires_at": {
+          "name": "expires_at",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "token_type": {
+          "name": "token_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "scope": {
+          "name": "scope",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "id_token": {
+          "name": "id_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "session_state": {
+          "name": "session_state",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {
+        "accounts_email_idx": {
+          "name": "accounts_email_idx",
+          "columns": [
+            {
+              "expression": "email",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "accounts_userId_client_profiles_id_fk": {
+          "name": "accounts_userId_client_profiles_id_fk",
+          "tableFrom": "accounts",
+          "tableTo": "client_profiles",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.activityLogs": {
+      "name": "activityLogs",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "serial",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "clientId": {
+          "name": "clientId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "action": {
+          "name": "action",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "timestamp": {
+          "name": "timestamp",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "ip_address": {
+          "name": "ip_address",
+          "type": "varchar(45)",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {
+        "activity_logs_user_idx": {
+          "name": "activity_logs_user_idx",
+          "columns": [
+            {
+              "expression": "userId",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "activity_logs_client_idx": {
+          "name": "activity_logs_client_idx",
+          "columns": [
+            {
+              "expression": "clientId",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "activityLogs_userId_users_id_fk": {
+          "name": "activityLogs_userId_users_id_fk",
+          "tableFrom": "activityLogs",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        },
+        "activityLogs_clientId_client_profiles_id_fk": {
+          "name": "activityLogs_clientId_client_profiles_id_fk",
+          "tableFrom": "activityLogs",
+          "tableTo": "client_profiles",
+          "columnsFrom": [
+            "clientId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.authenticators": {
+      "name": "authenticators",
+      "schema": "",
+      "columns": {
+        "credentialID": {
+          "name": "credentialID",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "providerAccountId": {
+          "name": "providerAccountId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialPublicKey": {
+          "name": "credentialPublicKey",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "counter": {
+          "name": "counter",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialDeviceType": {
+          "name": "credentialDeviceType",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialBackedUp": {
+          "name": "credentialBackedUp",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "transports": {
+          "name": "transports",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "authenticators_userId_users_id_fk": {
+          "name": "authenticators_userId_users_id_fk",
+          "tableFrom": "authenticators",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "authenticators_credentialID_unique": {
+          "name": "authenticators_credentialID_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "credentialID"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.client_profiles": {
+      "name": "client_profiles",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "display_name": {
+          "name": "display_name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "username": {
+          "name": "username",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "bio": {
+          "name": "bio",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "job_title": {
+          "name": "job_title",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "company": {
+          "name": "company",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "industry": {
+          "name": "industry",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "phone": {
+          "name": "phone",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "website": {
+          "name": "website",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "location": {
+          "name": "location",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "account_type": {
+          "name": "account_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'individual'"
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "plan": {
+          "name": "plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'free'"
+        },
+        "timezone": {
+          "name": "timezone",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'UTC'"
+        },
+        "language": {
+          "name": "language",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'en'"
+        },
+        "two_factor_enabled": {
+          "name": "two_factor_enabled",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "email_verified": {
+          "name": "email_verified",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "total_submissions": {
+          "name": "total_submissions",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "notes": {
+          "name": "notes",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "tags": {
+          "name": "tags",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "client_profile_email_idx": {
+          "name": "client_profile_email_idx",
+          "columns": [
+            {
+              "expression": "email",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_status_idx": {
+          "name": "client_profile_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_plan_idx": {
+          "name": "client_profile_plan_idx",
+          "columns": [
+            {
+              "expression": "plan",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_account_type_idx": {
+          "name": "client_profile_account_type_idx",
+          "columns": [
+            {
+              "expression": "account_type",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_username_idx": {
+          "name": "client_profile_username_idx",
+          "columns": [
+            {
+              "expression": "username",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_created_at_idx": {
+          "name": "client_profile_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "client_profiles_username_unique": {
+          "name": "client_profiles_username_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "username"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.comments": {
+      "name": "comments",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "content": {
+          "name": "content",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "itemId": {
+          "name": "itemId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "rating": {
+          "name": "rating",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": true,
+          "default": 0
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "deleted_at": {
+          "name": "deleted_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "comments_userId_users_id_fk": {
+          "name": "comments_userId_users_id_fk",
+          "tableFrom": "comments",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.newsletter_subscriptions": {
+      "name": "newsletter_subscriptions",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "is_active": {
+          "name": "is_active",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": true,
+          "default": true
+        },
+        "subscribed_at": {
+          "name": "subscribed_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "unsubscribed_at": {
+          "name": "unsubscribed_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "last_email_sent": {
+          "name": "last_email_sent",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "source": {
+          "name": "source",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'footer'"
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "newsletter_subscriptions_email_unique": {
+          "name": "newsletter_subscriptions_email_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "email"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.passwordResetTokens": {
+      "name": "passwordResetTokens",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "token": {
+          "name": "token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "passwordResetTokens_token_unique": {
+          "name": "passwordResetTokens_token_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "token"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.roles": {
+      "name": "roles",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "description": {
+          "name": "description",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "permissions": {
+          "name": "permissions",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "created_by": {
+          "name": "created_by",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'system'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "roles_status_idx": {
+          "name": "roles_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "roles_created_at_idx": {
+          "name": "roles_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.sessions": {
+      "name": "sessions",
+      "schema": "",
+      "columns": {
+        "sessionToken": {
+          "name": "sessionToken",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "sessions_userId_users_id_fk": {
+          "name": "sessions_userId_users_id_fk",
+          "tableFrom": "sessions",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.subscription_history": {
+      "name": "subscription_history",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "subscription_id": {
+          "name": "subscription_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "action": {
+          "name": "action",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "previous_status": {
+          "name": "previous_status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "new_status": {
+          "name": "new_status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "previous_plan": {
+          "name": "previous_plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "new_plan": {
+          "name": "new_plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "reason": {
+          "name": "reason",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "metadata": {
+          "name": "metadata",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "subscription_history_idx": {
+          "name": "subscription_history_idx",
+          "columns": [
+            {
+              "expression": "subscription_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_action_idx": {
+          "name": "subscription_action_idx",
+          "columns": [
+            {
+              "expression": "action",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_history_created_at_idx": {
+          "name": "subscription_history_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "subscription_history_subscription_id_subscriptions_id_fk": {
+          "name": "subscription_history_subscription_id_subscriptions_id_fk",
+          "tableFrom": "subscription_history",
+          "tableTo": "subscriptions",
+          "columnsFrom": [
+            "subscription_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.subscriptions": {
+      "name": "subscriptions",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "user_id": {
+          "name": "user_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "plan_id": {
+          "name": "plan_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'free'"
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'pending'"
+        },
+        "start_date": {
+          "name": "start_date",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "end_date": {
+          "name": "end_date",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "payment_provider": {
+          "name": "payment_provider",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'stripe'"
+        },
+        "subscription_id": {
+          "name": "subscription_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "invoice_id": {
+          "name": "invoice_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "amount_due": {
+          "name": "amount_due",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "amount_paid": {
+          "name": "amount_paid",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "price_id": {
+          "name": "price_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "customer_id": {
+          "name": "customer_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "currency": {
+          "name": "currency",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'usd'"
+        },
+        "amount": {
+          "name": "amount",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "interval": {
+          "name": "interval",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'month'"
+        },
+        "interval_count": {
+          "name": "interval_count",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 1
+        },
+        "trial_start": {
+          "name": "trial_start",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "trial_end": {
+          "name": "trial_end",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "cancelled_at": {
+          "name": "cancelled_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "cancel_at_period_end": {
+          "name": "cancel_at_period_end",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "cancel_reason": {
+          "name": "cancel_reason",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "hosted_invoice_url": {
+          "name": "hosted_invoice_url",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "invoice_pdf": {
+          "name": "invoice_pdf",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "metadata": {
+          "name": "metadata",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "user_subscription_idx": {
+          "name": "user_subscription_idx",
+          "columns": [
+            {
+              "expression": "user_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_status_idx": {
+          "name": "subscription_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "provider_subscription_idx": {
+          "name": "provider_subscription_idx",
+          "columns": [
+            {
+              "expression": "payment_provider",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            },
+            {
+              "expression": "subscription_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": true,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_plan_idx": {
+          "name": "subscription_plan_idx",
+          "columns": [
+            {
+              "expression": "plan_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_created_at_idx": {
+          "name": "subscription_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "subscriptions_user_id_users_id_fk": {
+          "name": "subscriptions_user_id_users_id_fk",
+          "tableFrom": "subscriptions",
+          "tableTo": "users",
+          "columnsFrom": [
+            "user_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.users": {
+      "name": "users",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "username": {
+          "name": "username",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "emailVerified": {
+          "name": "emailVerified",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "image": {
+          "name": "image",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "password_hash": {
+          "name": "password_hash",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "title": {
+          "name": "title",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "avatar": {
+          "name": "avatar",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "role_id": {
+          "name": "role_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "created_by": {
+          "name": "created_by",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'system'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "deleted_at": {
+          "name": "deleted_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "users_role_id_roles_id_fk": {
+          "name": "users_role_id_roles_id_fk",
+          "tableFrom": "users",
+          "tableTo": "roles",
+          "columnsFrom": [
+            "role_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "set null",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "users_username_unique": {
+          "name": "users_username_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "username"
+          ]
+        },
+        "users_email_unique": {
+          "name": "users_email_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "email"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.verificationTokens": {
+      "name": "verificationTokens",
+      "schema": "",
+      "columns": {
+        "identifier": {
+          "name": "identifier",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "token": {
+          "name": "token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.votes": {
+      "name": "votes",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userid": {
+          "name": "userid",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "item_id": {
+          "name": "item_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "vote_type": {
+          "name": "vote_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'upvote'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "unique_user_item_vote_idx": {
+          "name": "unique_user_item_vote_idx",
+          "columns": [
+            {
+              "expression": "userid",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            },
+            {
+              "expression": "item_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": true,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "item_votes_idx": {
+          "name": "item_votes_idx",
+          "columns": [
+            {
+              "expression": "item_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "votes_created_at_idx": {
+          "name": "votes_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "votes_userid_users_id_fk": {
+          "name": "votes_userid_users_id_fk",
+          "tableFrom": "votes",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userid"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    }
+  },
+  "enums": {},
+  "schemas": {},
+  "sequences": {},
+  "roles": {},
+  "policies": {},
+  "views": {},
+  "_meta": {
+    "columns": {},
+    "schemas": {},
+    "tables": {}
+  }
+}
\ No newline at end of file
diff --git a/lib/db/migrations/meta/0021_cleanup_is_admin_column_snapshot.json b/lib/db/migrations/meta/0021_cleanup_is_admin_column_snapshot.json
new file mode 100644
index 0000000..282c5ca
--- /dev/null
+++ b/lib/db/migrations/meta/0021_cleanup_is_admin_column_snapshot.json
@@ -0,0 +1,1635 @@
+{
+  "id": "21000000-0000-0000-0000-000000000021",
+  "prevId": "20000000-0000-0000-0000-000000000020",
+  "version": "7",
+  "dialect": "postgresql",
+  "tables": {
+    "public.accounts": {
+      "name": "accounts",
+      "schema": "",
+      "columns": {
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "type": {
+          "name": "type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "provider": {
+          "name": "provider",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "providerAccountId": {
+          "name": "providerAccountId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "password_hash": {
+          "name": "password_hash",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "refresh_token": {
+          "name": "refresh_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "access_token": {
+          "name": "access_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "expires_at": {
+          "name": "expires_at",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "token_type": {
+          "name": "token_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "scope": {
+          "name": "scope",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "id_token": {
+          "name": "id_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "session_state": {
+          "name": "session_state",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {
+        "accounts_email_idx": {
+          "name": "accounts_email_idx",
+          "columns": [
+            {
+              "expression": "email",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "accounts_userId_client_profiles_id_fk": {
+          "name": "accounts_userId_client_profiles_id_fk",
+          "tableFrom": "accounts",
+          "tableTo": "client_profiles",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.activityLogs": {
+      "name": "activityLogs",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "serial",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "clientId": {
+          "name": "clientId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "action": {
+          "name": "action",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "timestamp": {
+          "name": "timestamp",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "ip_address": {
+          "name": "ip_address",
+          "type": "varchar(45)",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {
+        "activity_logs_user_idx": {
+          "name": "activity_logs_user_idx",
+          "columns": [
+            {
+              "expression": "userId",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "activity_logs_client_idx": {
+          "name": "activity_logs_client_idx",
+          "columns": [
+            {
+              "expression": "clientId",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "activityLogs_userId_users_id_fk": {
+          "name": "activityLogs_userId_users_id_fk",
+          "tableFrom": "activityLogs",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        },
+        "activityLogs_clientId_client_profiles_id_fk": {
+          "name": "activityLogs_clientId_client_profiles_id_fk",
+          "tableFrom": "activityLogs",
+          "tableTo": "client_profiles",
+          "columnsFrom": [
+            "clientId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.authenticators": {
+      "name": "authenticators",
+      "schema": "",
+      "columns": {
+        "credentialID": {
+          "name": "credentialID",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "providerAccountId": {
+          "name": "providerAccountId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialPublicKey": {
+          "name": "credentialPublicKey",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "counter": {
+          "name": "counter",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialDeviceType": {
+          "name": "credentialDeviceType",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialBackedUp": {
+          "name": "credentialBackedUp",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "transports": {
+          "name": "transports",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "authenticators_userId_users_id_fk": {
+          "name": "authenticators_userId_users_id_fk",
+          "tableFrom": "authenticators",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "authenticators_credentialID_unique": {
+          "name": "authenticators_credentialID_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "credentialID"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.client_profiles": {
+      "name": "client_profiles",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "display_name": {
+          "name": "display_name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "username": {
+          "name": "username",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "bio": {
+          "name": "bio",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "job_title": {
+          "name": "job_title",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "company": {
+          "name": "company",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "industry": {
+          "name": "industry",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "phone": {
+          "name": "phone",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "website": {
+          "name": "website",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "location": {
+          "name": "location",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "account_type": {
+          "name": "account_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'individual'"
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "plan": {
+          "name": "plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'free'"
+        },
+        "timezone": {
+          "name": "timezone",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'UTC'"
+        },
+        "language": {
+          "name": "language",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'en'"
+        },
+        "two_factor_enabled": {
+          "name": "two_factor_enabled",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "email_verified": {
+          "name": "email_verified",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "total_submissions": {
+          "name": "total_submissions",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "notes": {
+          "name": "notes",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "tags": {
+          "name": "tags",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "client_profile_email_idx": {
+          "name": "client_profile_email_idx",
+          "columns": [
+            {
+              "expression": "email",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_status_idx": {
+          "name": "client_profile_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_plan_idx": {
+          "name": "client_profile_plan_idx",
+          "columns": [
+            {
+              "expression": "plan",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_account_type_idx": {
+          "name": "client_profile_account_type_idx",
+          "columns": [
+            {
+              "expression": "account_type",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_username_idx": {
+          "name": "client_profile_username_idx",
+          "columns": [
+            {
+              "expression": "username",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_created_at_idx": {
+          "name": "client_profile_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "client_profiles_username_unique": {
+          "name": "client_profiles_username_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "username"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.comments": {
+      "name": "comments",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "content": {
+          "name": "content",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "itemId": {
+          "name": "itemId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "rating": {
+          "name": "rating",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": true,
+          "default": 0
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "deleted_at": {
+          "name": "deleted_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "comments_userId_users_id_fk": {
+          "name": "comments_userId_users_id_fk",
+          "tableFrom": "comments",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.newsletter_subscriptions": {
+      "name": "newsletter_subscriptions",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "is_active": {
+          "name": "is_active",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": true,
+          "default": true
+        },
+        "subscribed_at": {
+          "name": "subscribed_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "unsubscribed_at": {
+          "name": "unsubscribed_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "last_email_sent": {
+          "name": "last_email_sent",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "source": {
+          "name": "source",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'footer'"
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "newsletter_subscriptions_email_unique": {
+          "name": "newsletter_subscriptions_email_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "email"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.passwordResetTokens": {
+      "name": "passwordResetTokens",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "token": {
+          "name": "token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "passwordResetTokens_token_unique": {
+          "name": "passwordResetTokens_token_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "token"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.roles": {
+      "name": "roles",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "description": {
+          "name": "description",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "permissions": {
+          "name": "permissions",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "created_by": {
+          "name": "created_by",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'system'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "roles_status_idx": {
+          "name": "roles_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "roles_created_at_idx": {
+          "name": "roles_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.sessions": {
+      "name": "sessions",
+      "schema": "",
+      "columns": {
+        "sessionToken": {
+          "name": "sessionToken",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "sessions_userId_users_id_fk": {
+          "name": "sessions_userId_users_id_fk",
+          "tableFrom": "sessions",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.subscription_history": {
+      "name": "subscription_history",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "subscription_id": {
+          "name": "subscription_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "action": {
+          "name": "action",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "previous_status": {
+          "name": "previous_status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "new_status": {
+          "name": "new_status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "previous_plan": {
+          "name": "previous_plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "new_plan": {
+          "name": "new_plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "reason": {
+          "name": "reason",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "metadata": {
+          "name": "metadata",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "subscription_history_idx": {
+          "name": "subscription_history_idx",
+          "columns": [
+            {
+              "expression": "subscription_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_action_idx": {
+          "name": "subscription_action_idx",
+          "columns": [
+            {
+              "expression": "action",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_history_created_at_idx": {
+          "name": "subscription_history_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "subscription_history_subscription_id_subscriptions_id_fk": {
+          "name": "subscription_history_subscription_id_subscriptions_id_fk",
+          "tableFrom": "subscription_history",
+          "tableTo": "subscriptions",
+          "columnsFrom": [
+            "subscription_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.subscriptions": {
+      "name": "subscriptions",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "user_id": {
+          "name": "user_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "plan_id": {
+          "name": "plan_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'free'"
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'pending'"
+        },
+        "start_date": {
+          "name": "start_date",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "end_date": {
+          "name": "end_date",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "payment_provider": {
+          "name": "payment_provider",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'stripe'"
+        },
+        "subscription_id": {
+          "name": "subscription_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "invoice_id": {
+          "name": "invoice_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "amount_due": {
+          "name": "amount_due",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "amount_paid": {
+          "name": "amount_paid",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "price_id": {
+          "name": "price_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "customer_id": {
+          "name": "customer_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "currency": {
+          "name": "currency",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'usd'"
+        },
+        "amount": {
+          "name": "amount",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "interval": {
+          "name": "interval",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'month'"
+        },
+        "interval_count": {
+          "name": "interval_count",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 1
+        },
+        "trial_start": {
+          "name": "trial_start",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "trial_end": {
+          "name": "trial_end",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "cancelled_at": {
+          "name": "cancelled_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "cancel_at_period_end": {
+          "name": "cancel_at_period_end",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "cancel_reason": {
+          "name": "cancel_reason",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "hosted_invoice_url": {
+          "name": "hosted_invoice_url",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "invoice_pdf": {
+          "name": "invoice_pdf",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "metadata": {
+          "name": "metadata",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "user_subscription_idx": {
+          "name": "user_subscription_idx",
+          "columns": [
+            {
+              "expression": "user_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_status_idx": {
+          "name": "subscription_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "provider_subscription_idx": {
+          "name": "provider_subscription_idx",
+          "columns": [
+            {
+              "expression": "payment_provider",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            },
+            {
+              "expression": "subscription_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": true,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_plan_idx": {
+          "name": "subscription_plan_idx",
+          "columns": [
+            {
+              "expression": "plan_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_created_at_idx": {
+          "name": "subscription_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "subscriptions_user_id_users_id_fk": {
+          "name": "subscriptions_user_id_users_id_fk",
+          "tableFrom": "subscriptions",
+          "tableTo": "users",
+          "columnsFrom": [
+            "user_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.users": {
+      "name": "users",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "username": {
+          "name": "username",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "emailVerified": {
+          "name": "emailVerified",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "image": {
+          "name": "image",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "password_hash": {
+          "name": "password_hash",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "title": {
+          "name": "title",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "avatar": {
+          "name": "avatar",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "role_id": {
+          "name": "role_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "created_by": {
+          "name": "created_by",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'system'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "deleted_at": {
+          "name": "deleted_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "users_role_id_roles_id_fk": {
+          "name": "users_role_id_roles_id_fk",
+          "tableFrom": "users",
+          "tableTo": "roles",
+          "columnsFrom": [
+            "role_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "set null",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "users_username_unique": {
+          "name": "users_username_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "username"
+          ]
+        },
+        "users_email_unique": {
+          "name": "users_email_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "email"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.verificationTokens": {
+      "name": "verificationTokens",
+      "schema": "",
+      "columns": {
+        "identifier": {
+          "name": "identifier",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "token": {
+          "name": "token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.votes": {
+      "name": "votes",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userid": {
+          "name": "userid",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "item_id": {
+          "name": "item_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "vote_type": {
+          "name": "vote_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'upvote'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "unique_user_item_vote_idx": {
+          "name": "unique_user_item_vote_idx",
+          "columns": [
+            {
+              "expression": "userid",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            },
+            {
+              "expression": "item_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": true,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "item_votes_idx": {
+          "name": "item_votes_idx",
+          "columns": [
+            {
+              "expression": "item_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "votes_created_at_idx": {
+          "name": "votes_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "votes_userid_users_id_fk": {
+          "name": "votes_userid_users_id_fk",
+          "tableFrom": "votes",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userid"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    }
+  },
+  "enums": {},
+  "schemas": {},
+  "sequences": {},
+  "roles": {},
+  "policies": {},
+  "views": {},
+  "_meta": {
+    "columns": {},
+    "schemas": {},
+    "tables": {}
+  }
+}
\ No newline at end of file
diff --git a/lib/db/migrations/meta/0022_add_userid_to_client_profiles_snapshot.json b/lib/db/migrations/meta/0022_add_userid_to_client_profiles_snapshot.json
new file mode 100644
index 0000000..720bdd0
--- /dev/null
+++ b/lib/db/migrations/meta/0022_add_userid_to_client_profiles_snapshot.json
@@ -0,0 +1,1635 @@
+{
+  "id": "22000000-0000-0000-0000-000000000022",
+  "prevId": "21000000-0000-0000-0000-000000000021",
+  "version": "7",
+  "dialect": "postgresql",
+  "tables": {
+    "public.accounts": {
+      "name": "accounts",
+      "schema": "",
+      "columns": {
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "type": {
+          "name": "type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "provider": {
+          "name": "provider",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "providerAccountId": {
+          "name": "providerAccountId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "password_hash": {
+          "name": "password_hash",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "refresh_token": {
+          "name": "refresh_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "access_token": {
+          "name": "access_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "expires_at": {
+          "name": "expires_at",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "token_type": {
+          "name": "token_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "scope": {
+          "name": "scope",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "id_token": {
+          "name": "id_token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "session_state": {
+          "name": "session_state",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {
+        "accounts_email_idx": {
+          "name": "accounts_email_idx",
+          "columns": [
+            {
+              "expression": "email",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "accounts_userId_client_profiles_id_fk": {
+          "name": "accounts_userId_client_profiles_id_fk",
+          "tableFrom": "accounts",
+          "tableTo": "client_profiles",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.activityLogs": {
+      "name": "activityLogs",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "serial",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "clientId": {
+          "name": "clientId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "action": {
+          "name": "action",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "timestamp": {
+          "name": "timestamp",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "ip_address": {
+          "name": "ip_address",
+          "type": "varchar(45)",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {
+        "activity_logs_user_idx": {
+          "name": "activity_logs_user_idx",
+          "columns": [
+            {
+              "expression": "userId",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "activity_logs_client_idx": {
+          "name": "activity_logs_client_idx",
+          "columns": [
+            {
+              "expression": "clientId",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "activityLogs_userId_users_id_fk": {
+          "name": "activityLogs_userId_users_id_fk",
+          "tableFrom": "activityLogs",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        },
+        "activityLogs_clientId_client_profiles_id_fk": {
+          "name": "activityLogs_clientId_client_profiles_id_fk",
+          "tableFrom": "activityLogs",
+          "tableTo": "client_profiles",
+          "columnsFrom": [
+            "clientId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.authenticators": {
+      "name": "authenticators",
+      "schema": "",
+      "columns": {
+        "credentialID": {
+          "name": "credentialID",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "providerAccountId": {
+          "name": "providerAccountId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialPublicKey": {
+          "name": "credentialPublicKey",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "counter": {
+          "name": "counter",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialDeviceType": {
+          "name": "credentialDeviceType",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "credentialBackedUp": {
+          "name": "credentialBackedUp",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "transports": {
+          "name": "transports",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "authenticators_userId_users_id_fk": {
+          "name": "authenticators_userId_users_id_fk",
+          "tableFrom": "authenticators",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "authenticators_credentialID_unique": {
+          "name": "authenticators_credentialID_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "credentialID"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.client_profiles": {
+      "name": "client_profiles",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "display_name": {
+          "name": "display_name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "username": {
+          "name": "username",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "bio": {
+          "name": "bio",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "job_title": {
+          "name": "job_title",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "company": {
+          "name": "company",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "industry": {
+          "name": "industry",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "phone": {
+          "name": "phone",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "website": {
+          "name": "website",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "location": {
+          "name": "location",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "account_type": {
+          "name": "account_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'individual'"
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "plan": {
+          "name": "plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'free'"
+        },
+        "timezone": {
+          "name": "timezone",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'UTC'"
+        },
+        "language": {
+          "name": "language",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'en'"
+        },
+        "two_factor_enabled": {
+          "name": "two_factor_enabled",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "email_verified": {
+          "name": "email_verified",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "total_submissions": {
+          "name": "total_submissions",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "notes": {
+          "name": "notes",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "tags": {
+          "name": "tags",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "client_profile_email_idx": {
+          "name": "client_profile_email_idx",
+          "columns": [
+            {
+              "expression": "email",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_status_idx": {
+          "name": "client_profile_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_plan_idx": {
+          "name": "client_profile_plan_idx",
+          "columns": [
+            {
+              "expression": "plan",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_account_type_idx": {
+          "name": "client_profile_account_type_idx",
+          "columns": [
+            {
+              "expression": "account_type",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_username_idx": {
+          "name": "client_profile_username_idx",
+          "columns": [
+            {
+              "expression": "username",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "client_profile_created_at_idx": {
+          "name": "client_profile_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "client_profiles_username_unique": {
+          "name": "client_profiles_username_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "username"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.comments": {
+      "name": "comments",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "content": {
+          "name": "content",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "itemId": {
+          "name": "itemId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "rating": {
+          "name": "rating",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": true,
+          "default": 0
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "deleted_at": {
+          "name": "deleted_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "comments_userId_users_id_fk": {
+          "name": "comments_userId_users_id_fk",
+          "tableFrom": "comments",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.newsletter_subscriptions": {
+      "name": "newsletter_subscriptions",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "is_active": {
+          "name": "is_active",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": true,
+          "default": true
+        },
+        "subscribed_at": {
+          "name": "subscribed_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "unsubscribed_at": {
+          "name": "unsubscribed_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "last_email_sent": {
+          "name": "last_email_sent",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "source": {
+          "name": "source",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'footer'"
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "newsletter_subscriptions_email_unique": {
+          "name": "newsletter_subscriptions_email_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "email"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.passwordResetTokens": {
+      "name": "passwordResetTokens",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "token": {
+          "name": "token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "passwordResetTokens_token_unique": {
+          "name": "passwordResetTokens_token_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "token"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.roles": {
+      "name": "roles",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "description": {
+          "name": "description",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "permissions": {
+          "name": "permissions",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "created_by": {
+          "name": "created_by",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'system'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "roles_status_idx": {
+          "name": "roles_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "roles_created_at_idx": {
+          "name": "roles_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.sessions": {
+      "name": "sessions",
+      "schema": "",
+      "columns": {
+        "sessionToken": {
+          "name": "sessionToken",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userId": {
+          "name": "userId",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "sessions_userId_users_id_fk": {
+          "name": "sessions_userId_users_id_fk",
+          "tableFrom": "sessions",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userId"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.subscription_history": {
+      "name": "subscription_history",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "subscription_id": {
+          "name": "subscription_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "action": {
+          "name": "action",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "previous_status": {
+          "name": "previous_status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "new_status": {
+          "name": "new_status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "previous_plan": {
+          "name": "previous_plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "new_plan": {
+          "name": "new_plan",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "reason": {
+          "name": "reason",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "metadata": {
+          "name": "metadata",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "subscription_history_idx": {
+          "name": "subscription_history_idx",
+          "columns": [
+            {
+              "expression": "subscription_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_action_idx": {
+          "name": "subscription_action_idx",
+          "columns": [
+            {
+              "expression": "action",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_history_created_at_idx": {
+          "name": "subscription_history_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "subscription_history_subscription_id_subscriptions_id_fk": {
+          "name": "subscription_history_subscription_id_subscriptions_id_fk",
+          "tableFrom": "subscription_history",
+          "tableTo": "subscriptions",
+          "columnsFrom": [
+            "subscription_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.subscriptions": {
+      "name": "subscriptions",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "user_id": {
+          "name": "user_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "plan_id": {
+          "name": "plan_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'free'"
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'pending'"
+        },
+        "start_date": {
+          "name": "start_date",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "end_date": {
+          "name": "end_date",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "payment_provider": {
+          "name": "payment_provider",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'stripe'"
+        },
+        "subscription_id": {
+          "name": "subscription_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "invoice_id": {
+          "name": "invoice_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "amount_due": {
+          "name": "amount_due",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "amount_paid": {
+          "name": "amount_paid",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "price_id": {
+          "name": "price_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "customer_id": {
+          "name": "customer_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "currency": {
+          "name": "currency",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'usd'"
+        },
+        "amount": {
+          "name": "amount",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 0
+        },
+        "interval": {
+          "name": "interval",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'month'"
+        },
+        "interval_count": {
+          "name": "interval_count",
+          "type": "integer",
+          "primaryKey": false,
+          "notNull": false,
+          "default": 1
+        },
+        "trial_start": {
+          "name": "trial_start",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "trial_end": {
+          "name": "trial_end",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "cancelled_at": {
+          "name": "cancelled_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "cancel_at_period_end": {
+          "name": "cancel_at_period_end",
+          "type": "boolean",
+          "primaryKey": false,
+          "notNull": false,
+          "default": false
+        },
+        "cancel_reason": {
+          "name": "cancel_reason",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "hosted_invoice_url": {
+          "name": "hosted_invoice_url",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "invoice_pdf": {
+          "name": "invoice_pdf",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "metadata": {
+          "name": "metadata",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "user_subscription_idx": {
+          "name": "user_subscription_idx",
+          "columns": [
+            {
+              "expression": "user_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_status_idx": {
+          "name": "subscription_status_idx",
+          "columns": [
+            {
+              "expression": "status",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "provider_subscription_idx": {
+          "name": "provider_subscription_idx",
+          "columns": [
+            {
+              "expression": "payment_provider",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            },
+            {
+              "expression": "subscription_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": true,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_plan_idx": {
+          "name": "subscription_plan_idx",
+          "columns": [
+            {
+              "expression": "plan_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "subscription_created_at_idx": {
+          "name": "subscription_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "subscriptions_user_id_users_id_fk": {
+          "name": "subscriptions_user_id_users_id_fk",
+          "tableFrom": "subscriptions",
+          "tableTo": "users",
+          "columnsFrom": [
+            "user_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.users": {
+      "name": "users",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "username": {
+          "name": "username",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "name": {
+          "name": "name",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "emailVerified": {
+          "name": "emailVerified",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "image": {
+          "name": "image",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "password_hash": {
+          "name": "password_hash",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "title": {
+          "name": "title",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "avatar": {
+          "name": "avatar",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "role_id": {
+          "name": "role_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false
+        },
+        "status": {
+          "name": "status",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'active'"
+        },
+        "created_by": {
+          "name": "created_by",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": false,
+          "default": "'system'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "deleted_at": {
+          "name": "deleted_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": false
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {
+        "users_role_id_roles_id_fk": {
+          "name": "users_role_id_roles_id_fk",
+          "tableFrom": "users",
+          "tableTo": "roles",
+          "columnsFrom": [
+            "role_id"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "set null",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {
+        "users_username_unique": {
+          "name": "users_username_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "username"
+          ]
+        },
+        "users_email_unique": {
+          "name": "users_email_unique",
+          "nullsNotDistinct": false,
+          "columns": [
+            "email"
+          ]
+        }
+      },
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.verificationTokens": {
+      "name": "verificationTokens",
+      "schema": "",
+      "columns": {
+        "identifier": {
+          "name": "identifier",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "email": {
+          "name": "email",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "token": {
+          "name": "token",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "expires": {
+          "name": "expires",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true
+        }
+      },
+      "indexes": {},
+      "foreignKeys": {},
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    },
+    "public.votes": {
+      "name": "votes",
+      "schema": "",
+      "columns": {
+        "id": {
+          "name": "id",
+          "type": "text",
+          "primaryKey": true,
+          "notNull": true
+        },
+        "userid": {
+          "name": "userid",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "item_id": {
+          "name": "item_id",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true
+        },
+        "vote_type": {
+          "name": "vote_type",
+          "type": "text",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "'upvote'"
+        },
+        "created_at": {
+          "name": "created_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        },
+        "updated_at": {
+          "name": "updated_at",
+          "type": "timestamp",
+          "primaryKey": false,
+          "notNull": true,
+          "default": "now()"
+        }
+      },
+      "indexes": {
+        "unique_user_item_vote_idx": {
+          "name": "unique_user_item_vote_idx",
+          "columns": [
+            {
+              "expression": "userid",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            },
+            {
+              "expression": "item_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": true,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "item_votes_idx": {
+          "name": "item_votes_idx",
+          "columns": [
+            {
+              "expression": "item_id",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        },
+        "votes_created_at_idx": {
+          "name": "votes_created_at_idx",
+          "columns": [
+            {
+              "expression": "created_at",
+              "isExpression": false,
+              "asc": true,
+              "nulls": "last"
+            }
+          ],
+          "isUnique": false,
+          "concurrently": false,
+          "method": "btree",
+          "with": {}
+        }
+      },
+      "foreignKeys": {
+        "votes_userid_users_id_fk": {
+          "name": "votes_userid_users_id_fk",
+          "tableFrom": "votes",
+          "tableTo": "users",
+          "columnsFrom": [
+            "userid"
+          ],
+          "columnsTo": [
+            "id"
+          ],
+          "onDelete": "cascade",
+          "onUpdate": "no action"
+        }
+      },
+      "compositePrimaryKeys": {},
+      "uniqueConstraints": {},
+      "policies": {},
+      "checkConstraints": {},
+      "isRLSEnabled": false
+    }
+  },
+  "enums": {},
+  "schemas": {},
+  "sequences": {},
+  "roles": {},
+  "policies": {},
+  "views": {},
+  "_meta": {
+    "columns": {},
+    "schemas": {},
+    "tables": {}
+  }
+}
\ No newline at end of file
diff --git a/lib/db/migrations/meta/_journal.json b/lib/db/migrations/meta/_journal.json
index d1c4003..15bdd20 100644
--- a/lib/db/migrations/meta/_journal.json
+++ b/lib/db/migrations/meta/_journal.json
@@ -143,7 +143,28 @@
       "breakpoints": true
     },
     {
-      "idx": 1,
+      "idx": 20,
+      "version": "7",
+      "when": 1755220000000,
+      "tag": "0020_create_payment_tables",
+      "breakpoints": true
+    },
+    {
+      "idx": 21,
+      "version": "7",
+      "when": 1755220100000,
+      "tag": "0021_cleanup_is_admin_column",
+      "breakpoints": true
+    },
+    {
+      "idx": 22,
+      "version": "7",
+      "when": 1755220200000,
+      "tag": "0022_add_userid_to_client_profiles",
+      "breakpoints": true
+    },
+    {
+      "idx": 23,
       "version": "7",
       "when": 1755317817331,
       "tag": "0001_dusty_demogoblin",
diff --git a/lib/db/migrations/relations.ts b/lib/db/migrations/relations.ts
index 0ccd2ae..ef6161f 100644
--- a/lib/db/migrations/relations.ts
+++ b/lib/db/migrations/relations.ts
@@ -1,27 +1,22 @@
 import { relations } from "drizzle-orm/relations";
-import { users, activityLogs, authenticators, sessions, comments, votes, subscriptions, subscriptionHistory } from "./schema";
+import { users, authenticators, sessions, comments, votes, activityLogs, clientProfiles, subscriptions, subscriptionHistory, paymentAccounts, paymentProviders } from "./schema";
 
-export const activityLogsRelations = relations(activityLogs, ({one}) => ({
+export const authenticatorsRelations = relations(authenticators, ({one}) => ({
 	user: one(users, {
-		fields: [activityLogs.userId],
+		fields: [authenticators.userId],
 		references: [users.id]
 	}),
 }));
 
 export const usersRelations = relations(users, ({many}) => ({
-	activityLogs: many(activityLogs),
 	authenticators: many(authenticators),
 	sessions: many(sessions),
 	comments: many(comments),
 	votes: many(votes),
+	activityLogs: many(activityLogs),
 	subscriptions: many(subscriptions),
-}));
-
-export const authenticatorsRelations = relations(authenticators, ({one}) => ({
-	user: one(users, {
-		fields: [authenticators.userId],
-		references: [users.id]
-	}),
+	clientProfiles: many(clientProfiles),
+	paymentAccounts: many(paymentAccounts),
 }));
 
 export const sessionsRelations = relations(sessions, ({one}) => ({
@@ -45,6 +40,25 @@ export const votesRelations = relations(votes, ({one}) => ({
 	}),
 }));
 
+export const activityLogsRelations = relations(activityLogs, ({one}) => ({
+	user: one(users, {
+		fields: [activityLogs.userId],
+		references: [users.id]
+	}),
+	clientProfile: one(clientProfiles, {
+		fields: [activityLogs.clientId],
+		references: [clientProfiles.id]
+	}),
+}));
+
+export const clientProfilesRelations = relations(clientProfiles, ({one, many}) => ({
+	activityLogs: many(activityLogs),
+	user: one(users, {
+		fields: [clientProfiles.userId],
+		references: [users.id]
+	}),
+}));
+
 export const subscriptionHistoryRelations = relations(subscriptionHistory, ({one}) => ({
 	subscription: one(subscriptions, {
 		fields: [subscriptionHistory.subscriptionId],
@@ -58,4 +72,19 @@ export const subscriptionsRelations = relations(subscriptions, ({one, many}) =>
 		fields: [subscriptions.userId],
 		references: [users.id]
 	}),
+}));
+
+export const paymentAccountsRelations = relations(paymentAccounts, ({one}) => ({
+	user: one(users, {
+		fields: [paymentAccounts.userId],
+		references: [users.id]
+	}),
+	paymentProvider: one(paymentProviders, {
+		fields: [paymentAccounts.providerId],
+		references: [paymentProviders.id]
+	}),
+}));
+
+export const paymentProvidersRelations = relations(paymentProviders, ({many}) => ({
+	paymentAccounts: many(paymentAccounts),
 }));
\ No newline at end of file
diff --git a/lib/db/migrations/schema.ts b/lib/db/migrations/schema.ts
index 89be33a..b638ee0 100644
--- a/lib/db/migrations/schema.ts
+++ b/lib/db/migrations/schema.ts
@@ -1,4 +1,5 @@
-import { pgTable, unique, text, timestamp, boolean, foreignKey, serial, varchar, integer, index, uniqueIndex, primaryKey } from "drizzle-orm/pg-core";
+import { pgTable, unique, text, timestamp, boolean, foreignKey, integer, index, uniqueIndex, serial, varchar, primaryKey } from "drizzle-orm/pg-core"
+
 
 
 export const passwordResetTokens = pgTable("passwordResetTokens", {
@@ -10,16 +11,16 @@ export const passwordResetTokens = pgTable("passwordResetTokens", {
 	unique("passwordResetTokens_token_unique").on(table.token),
 ]);
 
-export const newsletterSubscriptions = pgTable("newsletterSubscriptions", {
+export const newsletterSubscriptions = pgTable("newsletter_subscriptions", {
 	id: text().primaryKey().notNull(),
 	email: text().notNull(),
-	isActive: boolean("is_active").default(true).notNull(),
-	subscribedAt: timestamp("subscribed_at", { mode: 'string' }).defaultNow().notNull(),
-	unsubscribedAt: timestamp("unsubscribed_at", { mode: 'string' }),
-	lastEmailSent: timestamp("last_email_sent", { mode: 'string' }),
-	source: text().default('footer'),
+	firstName: text("first_name"),
+	lastName: text("last_name"),
+	isSubscribed: boolean("is_subscribed").default(true).notNull(),
+	createdAt: timestamp("created_at", { mode: 'string' }).defaultNow().notNull(),
+	updatedAt: timestamp("updated_at", { mode: 'string' }).defaultNow().notNull(),
 }, (table) => [
-	unique("newsletterSubscriptions_email_unique").on(table.email),
+	unique("newsletter_subscriptions_email_unique").on(table.email),
 ]);
 
 export const users = pgTable("users", {
@@ -43,20 +44,6 @@ export const users = pgTable("users", {
 	unique("users_username_unique").on(table.username),
 ]);
 
-export const activityLogs = pgTable("activityLogs", {
-	id: serial().primaryKey().notNull(),
-	userId: text(),
-	action: text().notNull(),
-	timestamp: timestamp({ mode: 'string' }).defaultNow().notNull(),
-	ipAddress: varchar({ length: 45 }),
-}, (table) => [
-	foreignKey({
-			columns: [table.userId],
-			foreignColumns: [users.id],
-			name: "activityLogs_userId_users_id_fk"
-		}),
-]);
-
 export const authenticators = pgTable("authenticators", {
 	credentialId: text().notNull(),
 	userId: text().notNull(),
@@ -136,6 +123,28 @@ export const roles = pgTable("roles", {
 	index("roles_status_idx").using("btree", table.status.asc().nullsLast().op("text_ops")),
 ]);
 
+export const activityLogs = pgTable("activityLogs", {
+	id: serial().primaryKey().notNull(),
+	userId: text(),
+	action: text().notNull(),
+	timestamp: timestamp({ mode: 'string' }).defaultNow().notNull(),
+	ipAddress: varchar("ip_address", { length: 45 }),
+	clientId: text(),
+}, (table) => [
+	index("activity_logs_client_idx").using("btree", table.clientId.asc().nullsLast().op("text_ops")),
+	index("activity_logs_user_idx").using("btree", table.userId.asc().nullsLast().op("text_ops")),
+	foreignKey({
+			columns: [table.userId],
+			foreignColumns: [users.id],
+			name: "activityLogs_userId_users_id_fk"
+		}).onDelete("cascade"),
+	foreignKey({
+			columns: [table.clientId],
+			foreignColumns: [clientProfiles.id],
+			name: "activityLogs_clientId_client_profiles_id_fk"
+		}).onDelete("cascade"),
+]);
+
 export const subscriptionHistory = pgTable("subscription_history", {
 	id: text().primaryKey().notNull(),
 	subscriptionId: text("subscription_id").notNull(),
@@ -159,7 +168,7 @@ export const subscriptionHistory = pgTable("subscription_history", {
 ]);
 
 export const accounts = pgTable("accounts", {
-	userId: text(),
+	userId: text().notNull(),
 	type: text().notNull(),
 	provider: text().notNull(),
 	providerAccountId: text().notNull(),
@@ -182,7 +191,57 @@ export const accounts = pgTable("accounts", {
 	tags: text(),
 	email: text(),
 	passwordHash: text("password_hash"),
-});
+	userType: text("user_type").default('client').notNull(),
+}, (table) => [
+	index("accounts_email_idx").using("btree", table.email.asc().nullsLast().op("text_ops")),
+	index("accounts_userId_userType_idx").using("btree", table.userId.asc().nullsLast().op("text_ops"), table.userType.asc().nullsLast().op("text_ops")),
+]);
+
+export const subscriptions = pgTable("subscriptions", {
+	id: text().primaryKey().notNull(),
+	userId: text("user_id").notNull(),
+	status: text().notNull(),
+	trialStart: timestamp("trial_start", { mode: 'string' }),
+	trialEnd: timestamp("trial_end", { mode: 'string' }),
+	cancelAtPeriodEnd: boolean("cancel_at_period_end").default(false).notNull(),
+	createdAt: timestamp("created_at", { mode: 'string' }).defaultNow().notNull(),
+	updatedAt: timestamp("updated_at", { mode: 'string' }).defaultNow().notNull(),
+	stripeCustomerId: text("stripe_customer_id"),
+	stripeSubscriptionId: text("stripe_subscription_id"),
+	stripePriceId: text("stripe_price_id"),
+	stripeProductId: text("stripe_product_id"),
+	plan: text().notNull(),
+	currentPeriodStart: timestamp("current_period_start", { mode: 'string' }),
+	currentPeriodEnd: timestamp("current_period_end", { mode: 'string' }),
+	canceledAt: timestamp("canceled_at", { mode: 'string' }),
+	paymentMethodId: text("payment_method_id"),
+	billingEmail: text("billing_email"),
+	billingName: text("billing_name"),
+	billingAddress: text("billing_address"),
+	billingCity: text("billing_city"),
+	billingState: text("billing_state"),
+	billingPostalCode: text("billing_postal_code"),
+	billingCountry: text("billing_country"),
+	paymentProvider: text("payment_provider").default('stripe'),
+	subscriptionId: text("subscription_id"),
+	amount: integer().default(0),
+	invoiceId: text("invoice_id"),
+	amountDue: integer("amount_due").default(0),
+	amountPaid: integer("amount_paid").default(0),
+	hostedInvoiceUrl: text("hosted_invoice_url"),
+	invoicePdf: text("invoice_pdf"),
+}, (table) => [
+	index("stripe_customer_idx").using("btree", table.stripeCustomerId.asc().nullsLast().op("text_ops")),
+	index("stripe_subscription_idx").using("btree", table.stripeSubscriptionId.asc().nullsLast().op("text_ops")),
+	index("subscription_plan_idx").using("btree", table.plan.asc().nullsLast().op("text_ops")),
+	index("subscription_status_idx").using("btree", table.status.asc().nullsLast().op("text_ops")),
+	index("user_subscription_idx").using("btree", table.userId.asc().nullsLast().op("text_ops")),
+	foreignKey({
+			columns: [table.userId],
+			foreignColumns: [users.id],
+			name: "subscriptions_user_id_users_id_fk"
+		}).onDelete("cascade"),
+]);
 
 export const clientProfiles = pgTable("client_profiles", {
 	id: text().primaryKey().notNull(),
@@ -209,52 +268,61 @@ export const clientProfiles = pgTable("client_profiles", {
 	updatedAt: timestamp("updated_at", { mode: 'string' }).defaultNow().notNull(),
 	email: text(),
 	name: text(),
+	userId: text().notNull(),
 }, (table) => [
 	index("client_profile_account_type_idx").using("btree", table.accountType.asc().nullsLast().op("text_ops")),
 	index("client_profile_created_at_idx").using("btree", table.createdAt.asc().nullsLast().op("timestamp_ops")),
 	index("client_profile_email_idx").using("btree", table.email.asc().nullsLast().op("text_ops")),
 	index("client_profile_plan_idx").using("btree", table.plan.asc().nullsLast().op("text_ops")),
 	index("client_profile_status_idx").using("btree", table.status.asc().nullsLast().op("text_ops")),
+	index("client_profile_user_id_idx").using("btree", table.userId.asc().nullsLast().op("text_ops")),
 	index("client_profile_username_idx").using("btree", table.username.asc().nullsLast().op("text_ops")),
-
+	foreignKey({
+			columns: [table.userId],
+			foreignColumns: [users.id],
+			name: "client_profiles_userId_users_id_fk"
+		}).onDelete("cascade"),
+	unique("client_profiles_username_unique").on(table.username),
+	unique("client_profiles_email_unique").on(table.email),
 ]);
 
-export const subscriptions = pgTable("subscriptions", {
+export const paymentAccounts = pgTable("paymentAccounts", {
 	id: text().primaryKey().notNull(),
-	userId: text("user_id").notNull(),
-	status: text().notNull(),
-	trialStart: timestamp("trial_start", { mode: 'string' }),
-	trialEnd: timestamp("trial_end", { mode: 'string' }),
-	cancelAtPeriodEnd: boolean("cancel_at_period_end").default(false).notNull(),
+	userId: text().notNull(),
+	providerId: text().notNull(),
+	customerId: text().notNull(),
+	accountId: text(),
+	lastUsed: timestamp({ mode: 'string' }),
 	createdAt: timestamp("created_at", { mode: 'string' }).defaultNow().notNull(),
 	updatedAt: timestamp("updated_at", { mode: 'string' }).defaultNow().notNull(),
-	stripeCustomerId: text("stripe_customer_id"),
-	stripeSubscriptionId: text("stripe_subscription_id"),
-	stripePriceId: text("stripe_price_id"),
-	stripeProductId: text("stripe_product_id"),
-	plan: text().notNull(),
-	currentPeriodStart: timestamp("current_period_start", { mode: 'string' }),
-	currentPeriodEnd: timestamp("current_period_end", { mode: 'string' }),
-	canceledAt: timestamp("canceled_at", { mode: 'string' }),
-	paymentMethodId: text("payment_method_id"),
-	billingEmail: text("billing_email"),
-	billingName: text("billing_name"),
-	billingAddress: text("billing_address"),
-	billingCity: text("billing_city"),
-	billingState: text("billing_state"),
-	billingPostalCode: text("billing_postal_code"),
-	billingCountry: text("billing_country"),
 }, (table) => [
-	index("stripe_customer_idx").using("btree", table.stripeCustomerId.asc().nullsLast().op("text_ops")),
-	index("stripe_subscription_idx").using("btree", table.stripeSubscriptionId.asc().nullsLast().op("text_ops")),
-	index("subscription_plan_idx").using("btree", table.plan.asc().nullsLast().op("text_ops")),
-	index("subscription_status_idx").using("btree", table.status.asc().nullsLast().op("text_ops")),
-	index("user_subscription_idx").using("btree", table.userId.asc().nullsLast().op("text_ops")),
+	uniqueIndex("customer_provider_unique_idx").using("btree", table.customerId.asc().nullsLast().op("text_ops"), table.providerId.asc().nullsLast().op("text_ops")),
+	index("payment_account_created_at_idx").using("btree", table.createdAt.asc().nullsLast().op("timestamp_ops")),
+	index("payment_account_customer_id_idx").using("btree", table.customerId.asc().nullsLast().op("text_ops")),
+	index("payment_account_provider_idx").using("btree", table.providerId.asc().nullsLast().op("text_ops")),
+	uniqueIndex("user_provider_unique_idx").using("btree", table.userId.asc().nullsLast().op("text_ops"), table.providerId.asc().nullsLast().op("text_ops")),
 	foreignKey({
 			columns: [table.userId],
 			foreignColumns: [users.id],
-			name: "subscriptions_user_id_users_id_fk"
+			name: "paymentAccounts_userId_users_id_fk"
 		}).onDelete("cascade"),
+	foreignKey({
+			columns: [table.providerId],
+			foreignColumns: [paymentProviders.id],
+			name: "paymentAccounts_providerId_paymentProviders_id_fk"
+		}).onDelete("cascade"),
+]);
+
+export const paymentProviders = pgTable("paymentProviders", {
+	id: text().primaryKey().notNull(),
+	name: text().notNull(),
+	isActive: boolean("is_active").default(true).notNull(),
+	createdAt: timestamp("created_at", { mode: 'string' }).defaultNow().notNull(),
+	updatedAt: timestamp("updated_at", { mode: 'string' }).defaultNow().notNull(),
+}, (table) => [
+	index("payment_provider_active_idx").using("btree", table.isActive.asc().nullsLast().op("bool_ops")),
+	index("payment_provider_created_at_idx").using("btree", table.createdAt.asc().nullsLast().op("timestamp_ops")),
+	unique("paymentProviders_name_unique").on(table.name),
 ]);
 
 export const verificationTokens = pgTable("verificationTokens", {
diff --git a/lib/db/queries.ts b/lib/db/queries.ts
index c012302..0d173dc 100644
--- a/lib/db/queries.ts
+++ b/lib/db/queries.ts
@@ -24,13 +24,14 @@ import {
   type SubscriptionWithUser,
   accounts,
   paymentProviders,
-  paymentAccounts
+  paymentAccounts,
+  clientProfiles
 } from "./schema";
 import { desc, isNull, count, asc, lte } from "drizzle-orm";
 import type { NewComment, CommentWithUser } from "@/lib/types/comment";
 import type { ClientProfile, NewClientProfile, OldPaymentProvider, PaymentAccount, NewPaymentAccount, NewPaymentProvider } from "./schema";
-import { clientProfiles } from "./schema";
-import { randomUUID } from "crypto";
+
+// import { randomUUID } from "crypto"; // Removed for Edge Runtime compatibility
 
 import { PaymentPlan } from "../constants";
 import { comparePasswords } from "../auth/credentials";
@@ -1002,7 +1003,7 @@ export async function createClientAccount(userId: string | undefined, email: str
       userId: resolvedUserId, // Must reference client_profiles.id
       type: "credentials" as any,
       provider: "credentials",
-      providerAccountId: randomUUID(), // Opaque stable identifier per provider
+      providerAccountId: crypto.randomUUID(), // Opaque stable identifier per provider
       email: normalizedEmail,
       passwordHash: passwordHash || null,
       refresh_token: null,
diff --git a/lib/db/schema.ts b/lib/db/schema.ts
index cff76ab..0670e29 100644
--- a/lib/db/schema.ts
+++ b/lib/db/schema.ts
@@ -87,6 +87,9 @@ export const clientProfiles = pgTable(
     id: text("id")
       .primaryKey()
       .$defaultFn(() => crypto.randomUUID()),
+    userId: text("userId")
+      .notNull()
+      .references(() => users.id, { onDelete: "cascade" }),
     email: text("email").notNull(),
     name: text("name").notNull(),
     displayName: text("display_name"),
@@ -118,6 +121,7 @@ export const clientProfiles = pgTable(
     updatedAt: timestamp("updated_at").notNull().defaultNow(),
   },
   (clientProfile) => [
+    index("client_profile_user_id_idx").on(clientProfile.userId),
     index("client_profile_email_idx").on(clientProfile.email),
     index("client_profile_status_idx").on(clientProfile.status),
     index("client_profile_plan_idx").on(clientProfile.plan),
@@ -181,7 +185,7 @@ export const activityLogs = pgTable("activityLogs", {
   clientId: text("clientId").references(() => clientProfiles.id, { onDelete: "cascade" }), // For client activities
   action: text("action").notNull(),
   timestamp: timestamp("timestamp").notNull().defaultNow(),
-  ipAddress: varchar("ip_address", { length: 45 }),
+  ipAddress: varchar("ip_address", { length: 45 }), // Map to actual DB column name
 }, (table) => [
   index("activity_logs_user_idx").on(table.userId),
   index("activity_logs_client_idx").on(table.clientId),
diff --git a/middleware.ts b/middleware.ts
index a97bfbc..1413fce 100644
--- a/middleware.ts
+++ b/middleware.ts
@@ -16,6 +16,42 @@ const intl = createIntlMiddleware(routing);
 const ADMIN_PREFIX = "/admin";
 const ADMIN_SIGNIN = "/admin/auth/signin";
 
+/* ────────────────────────────────── NextAuth guard ────────────────────────────────── */
+
+async function nextAuthGuard(req: NextRequest, baseRes: NextResponse): Promise<NextResponse> {
+  console.log('DEBUG: NextAuth guard called for', req.nextUrl.pathname);
+  
+  try {
+    // Import auth dynamically to avoid Edge Runtime issues
+    const { auth } = await import("@/lib/auth");
+    const session = await auth();
+    console.log('DEBUG: NextAuth session:', { 
+      exists: !!session, 
+      user: !!session?.user, 
+      isAdmin: session?.user?.isAdmin,
+      email: session?.user?.email 
+    });
+    
+    if (session?.user?.isAdmin) {
+      console.log('DEBUG: Admin user authenticated, allowing access');
+      return baseRes;
+    }
+    
+    console.log('DEBUG: No admin session, redirecting to signin');
+    const url = req.nextUrl.clone();
+    const locale = req.nextUrl.pathname.split('/')[1];
+    url.pathname = `/${locale}${ADMIN_SIGNIN}`;
+    url.searchParams.set('callbackUrl', req.nextUrl.pathname);
+    return NextResponse.redirect(url);
+  } catch (error) {
+    console.error('DEBUG: NextAuth guard error:', error);
+    const url = req.nextUrl.clone();
+    const locale = req.nextUrl.pathname.split('/')[1];
+    url.pathname = `/${locale}${ADMIN_SIGNIN}`;
+    return NextResponse.redirect(url);
+  }
+}
+
 /* ────────────────────────────── Supabase guard helper ────────────────────────────── */
 async function supabaseGuard(req: NextRequest, baseRes: NextResponse): Promise<NextResponse> {
   // Refresh Supabase session & get proper cookies
@@ -128,15 +164,15 @@ export default async function middleware(req: NextRequest) {
   }
   
   if (pathWithoutLocale.startsWith(ADMIN_PREFIX) && pathWithoutLocale !== ADMIN_SIGNIN) {
+    console.log('DEBUG: Admin route accessed:', pathWithoutLocale, 'provider:', cfg.provider);
+    
     if (cfg.provider === "supabase") {
       return supabaseGuard(req, intlResponse);
     } else if (cfg.provider === "next-auth") {
-      // Skip NextAuth guard in Edge Runtime to avoid Node.js modules
-      // Admin access will be handled by client-side logic
-      return intlResponse;
+      return nextAuthGuard(req, intlResponse);
     } else if (cfg.provider === "both") {
-      // For 'both' provider, only use Supabase guard in Edge Runtime
-      return supabaseGuard(req, intlResponse);
+      // Check NextAuth session first
+      return nextAuthGuard(req, intlResponse);
     }
   }
 
